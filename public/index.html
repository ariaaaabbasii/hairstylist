<!DOCTYPE html>
<html lang="nl" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- SEO Optimized Title -->
    <title>Diamond Haarsalon Leiden - Kapper & Haarstyling | Boek Nu</title>
    <!-- SEO Optimized Description -->
    <meta name="description" content="Professionele kapper in Leiden. Diamond Haarsalon biedt knippen, kleuren, balayage, keratine en meer. Ervaar luxe haarverzorging. Maak vandaag nog uw afspraak!">

    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>

    <!-- Configure Tailwind colors -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        gold: {
                            light: '#f7eed9',
                            DEFAULT: '#d4af37',
                            dark: '#b8860b'
                        },
                        brand: {
                            primary: '#b8860b', // Dark Gold
                            secondary: '#d4af37', // Medium Gold
                            light: '#f7eed9', // Light Gold/Cream
                            dark: '#3a2d0c', // Dark Brown/Gold Tint
                            darker: '#1c1605' // Very Dark Brown/Near Black
                        }
                    },
                    fontFamily: {
                        'playfair': ['Playfair Display', 'serif'],
                        'poppins': ['Poppins', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400..900&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Fancybox CSS & JS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.css"/>
    <script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.umd.js"></script>

    <!-- REMOVED Axios as it wasn't used -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.7/axios.min.js"></script> -->

    <!-- Custom Styles -->
    <style>
        /* Base Typography & Smoothing */
        body {
            font-family: 'Poppins', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            scroll-behavior: smooth;
            background-color: theme('colors.neutral.50'); /* Ensure base bg */
            color: theme('colors.neutral.700'); /* Ensure base text color */
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Playfair Display', serif;
        }

        /* Custom scrollbar for chat messages and price modal */
        #chat-messages::-webkit-scrollbar,
        #price-modal-body::-webkit-scrollbar {
            width: 6px;
        }

        #chat-messages::-webkit-scrollbar-track,
        #price-modal-body::-webkit-scrollbar-track {
            background: theme('colors.neutral.100');
            border-radius: 10px;
        }

        #chat-messages::-webkit-scrollbar-thumb,
        #price-modal-body::-webkit-scrollbar-thumb {
            background: theme('colors.brand.secondary');
            border-radius: 10px;
        }

        #chat-messages::-webkit-scrollbar-thumb:hover,
        #price-modal-body::-webkit-scrollbar-thumb:hover {
            background: theme('colors.brand.primary');
        }

        /* Header shrink effect styling */
        #main-header {
            transition: all 0.4s ease;
            background-color: transparent; /* Start transparent */
            color: theme('colors.white'); /* Default text color for transparent header */
        }

        #main-header.header-scrolled {
            background-color: rgba(255, 255, 255, 0.98); /* Slightly transparent white */
            box-shadow: 0 4px 10px -1px rgba(0, 0, 0, 0.1);
            padding-top: 0.75rem; /* Adjust padding */
            padding-bottom: 0.75rem;
            backdrop-filter: blur(10px);
            color: theme('colors.neutral.800'); /* Text color for scrolled header */
        }

        /* Style adjustments for links in scrolled header */
        #main-header.header-scrolled nav a:not(.button-cta) {
            color: theme('colors.neutral.800');
        }

        #main-header.header-scrolled nav a:hover:not(.button-cta) {
            color: theme('colors.brand.primary');
            border-color: theme('colors.brand.primary'); /* Adjust hover border */
        }

        /* Logo text color adjustment */
        #main-header .logo-text {
            color: theme('colors.brand.secondary'); /* Initial gold color */
            transition: color 0.3s ease;
        }
        #main-header.header-scrolled .logo-text {
             color: theme('colors.brand.primary'); /* Darker gold on scroll */
        }

        /* Phone link color adjustment */
        #main-header .phone-link {
            color: theme('colors.white'); /* Initial white color */
            transition: color 0.3s ease;
        }
        #main-header.header-scrolled .phone-link {
            color: theme('colors.brand.primary'); /* Dark gold on scroll */
        }
        #main-header.header-scrolled .phone-link:hover {
            color: theme('colors.brand.dark');
        }

        /* Mobile menu button color adjustment */
        #main-header #mobile-menu-button {
             color: theme('colors.brand.secondary'); /* Initial gold color */
             transition: color 0.3s ease, background-color 0.3s ease;
        }
         #main-header.header-scrolled #mobile-menu-button {
            color: theme('colors.neutral.800'); /* Dark text on scroll */
        }
        #main-header.header-scrolled #mobile-menu-button:hover {
            color: theme('colors.brand.primary');
            background-color: theme('colors.gold.light');
        }


        /* Improved Mobile Menu Animation */
        .mobile-menu-container {
            transform-origin: top center;
            transition: transform 0.3s ease, opacity 0.3s ease, visibility 0.3s ease;
            transform: scaleY(0);
            opacity: 0;
            visibility: hidden;
            height: 0; /* Crucial for preventing interaction when hidden */
            overflow: hidden;
            position: absolute; /* Ensure it's correctly positioned */
            top: 100%; /* Position below the header */
            left: 0;
            width: 100%;
            background-color: white; /* Explicit background */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            border-top: 1px solid theme('colors.neutral.100');
        }

        .mobile-menu-container.menu-open {
            transform: scaleY(1);
            opacity: 1;
            visibility: visible;
            height: auto; /* Allow content to determine height */
            overflow: visible; /* Allow content to be seen */
        }

        /* Animation Keyframes */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideInLeft { from { opacity: 0; transform: translateX(-30px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes slideInRight { from { opacity: 0; transform: translateX(30px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes scaleIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } } /* Adjusted bounce */
        .animate-bounce-subtle { animation: bounce 1.5s infinite ease-in-out; } /* Slower bounce */

        /* Animation classes */
        .animate-on-scroll { opacity: 0; }
        .is-visible { opacity: 1; } /* State when animation is done */

        /* Apply animation name via CSS variable */
        .animate-on-scroll { --animation-name: fadeIn; } /* Default */
        .animate-fade-in { --animation-name: fadeIn; }
        .animate-slide-up { --animation-name: slideUp; }
        .animate-slide-in-left { --animation-name: slideInLeft; }
        .animate-slide-in-right { --animation-name: slideInRight; }
        .animate-scale-in { --animation-name: scaleIn; }

        /* Chat Window Animation */
        #chat-window {
            transition: opacity 0.3s ease-out, transform 0.3s ease-out;
            transform-origin: bottom right;
        }

        /* Chat Quick Reply (Example Style - Not implemented in current JS logic) */
        .chat-quick-reply {
            @apply px-3 py-1.5 bg-gold-light/50 text-brand-primary border border-gold-light rounded-full text-xs font-medium transition duration-200 cursor-pointer hover:bg-gold-light/80 hover:text-brand-dark focus:outline-none focus:ring-2 focus:ring-brand-secondary focus:ring-offset-1 active:scale-95;
        }

        /* Subtle noise background */
        .noise-bg {
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 800 800' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E");
        }

        /* Image hover effect */
        .hover-filter {
            transition: filter 0.4s ease, transform 0.4s ease;
        }

        .hover-filter:hover {
            filter: brightness(0.95) saturate(1.05); /* More subtle */
            transform: scale(1.03);
        }

        /* Gallery Item Hover Effects */
        .gallery-item {
            transition: transform 0.4s ease, box-shadow 0.4s ease;
            position: relative; /* Needed for overlay */
            overflow: hidden; /* Clip zoomed image */
        }

        .gallery-item:hover {
            transform: scale(1.03); /* Lift effect */
            box-shadow: 0 10px 20px rgba(0,0,0,0.1); /* Softer shadow */
        }

        /* Make image zoom slightly on gallery item hover */
        .gallery-item img {
            transition: transform 0.5s ease;
        }

        .gallery-item:hover img {
            transform: scale(1.1); /* Zoom image inside */
        }

        /* Overlay for gallery item */
        .gallery-overlay {
            @apply absolute inset-0 bg-black/60 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-10 cursor-pointer; /* Use group-hover */
        }

        /* Price Modal Transition Styles */
        #price-modal {
            transition: opacity 0.3s ease-in-out;
        }

        #price-modal > div > div { /* Target the inner content div */
            transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
        }

        /* Service cards improved hover effect */
        .service-card { /* Example class if you add service cards */
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .service-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        /* Improve accessibility - focus styles */
        a:focus-visible, button:focus-visible, input:focus-visible, textarea:focus-visible {
            outline: 3px solid theme('colors.brand.secondary'); /* More visible focus */
            outline-offset: 2px;
            border-radius: 4px; /* Optional: round the outline */
        }
        /* Ensure no double outline if element already has border */
         input:focus-visible, textarea:focus-visible {
            outline-offset: 1px;
        }


        /* Floating action buttons */
        .floating-btn {
            filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.15)); /* Slightly stronger shadow */
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .floating-btn:hover {
            transform: translateY(-5px) scale(1.05);
            filter: drop-shadow(0 10px 15px rgba(0, 0, 0, 0.15));
        }

        /* Testimonial card hover effect */
        .testimonial-card {
            transition: all 0.3s ease;
            border: 1px solid transparent; /* Base border */
        }

        .testimonial-card:hover {
            transform: translateY(-6px); /* Slightly more lift */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.07), 0 4px 6px -2px rgba(0, 0, 0, 0.04); /* Softer shadow */
            border-color: theme('colors.neutral.100');
        }

        /* Improved button base styles */
        .btn {
            @apply inline-flex items-center justify-center px-6 py-3 rounded-full font-medium transition-all duration-300 focus:outline-none;
            transition-timing-function: cubic-bezier(0.175, 0.885, 0.32, 1.275); /* Apply bounce effect timing */
        }
        .btn-primary {
            @apply btn bg-brand-primary text-white shadow-md hover:bg-brand-dark focus:ring-2 focus:ring-offset-2 focus:ring-brand-primary;
        }
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .btn-primary:active {
            transform: translateY(-1px);
        }

        .btn-secondary { /* Example secondary style */
             @apply btn border-2 border-white text-white hover:bg-white hover:text-neutral-900 focus:ring-2 focus:ring-offset-2 focus:ring-white;
        }
         #main-header.header-scrolled .btn-secondary { /* Adjust secondary button for scrolled header */
             @apply border-brand-primary text-brand-primary hover:bg-brand-primary hover:text-white focus:ring-brand-primary;
         }
        .btn-secondary:hover {
            transform: translateY(-3px);
        }
        .btn-secondary:active {
            transform: translateY(-1px);
        }


        /* Aspect ratio utility for modern browsers */
        .aspect-w-1 { aspect-ratio: 1 / 1; }
        .aspect-w-4 { aspect-ratio: 4 / 3; }
        .aspect-w-16 { aspect-ratio: 16 / 9; }
        .aspect-cover img { width: 100%; height: 100%; object-fit: cover; }

    </style>

    <!-- JSON-LD Structured Data for SEO -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "HairSalon",
      "name": "Diamond Haarsalon",
      "description": "Professionele kapper in Leiden voor knippen, kleuren, balayage, keratine behandelingen en meer. Ervaar luxe haarverzorging en persoonlijke aandacht.",
      "address": {
        "@type": "PostalAddress",
        "streetAddress": "Bevrijdingsplein 19",
        "addressLocality": "Leiden",
        "postalCode": "2321 BW",
        "addressCountry": "NL"
      },
      "telephone": "+31627403860",
      "email": "info@diamond.nl",
      "url": "https://www.jouwwebsiteurl.nl", // <-- !!! REPLACE with your actual website URL !!!
      "image": "https://www.jouwwebsiteurl.nl/Images/SalonMain.jpg", // <-- !!! REPLACE with absolute URL to a good representative image !!!
      "priceRange": "€€", // Optional: Adjust based on your pricing (e.g., €, €€, €€€)
      "openingHoursSpecification": [
        {
          "@type": "OpeningHoursSpecification",
          "dayOfWeek": [
            "Tuesday",
            "Wednesday",
            "Thursday",
            "Friday"
          ],
          "opens": "09:00",
          "closes": "18:00"
        },
        {
          "@type": "OpeningHoursSpecification",
          "dayOfWeek": "Saturday",
          "opens": "09:00",
          "closes": "17:00"
        },
        {
          "@type": "OpeningHoursSpecification",
          "dayOfWeek": [
            "Sunday",
            "Monday"
          ],
          "opens": "00:00", // Indicate closed
          "closes": "00:00"
        }
      ],
      "sameAs": [
        // <-- !!! REPLACE with your actual social media profile URLs !!!
        "https://www.facebook.com/jouwfacebookpagina",
        "https://www.instagram.com/jouwinstagramprofiel"
        // "https://www.pinterest.com/jouwpinterestprofiel"
      ],
      "potentialAction": {
            "@type": "ReserveAction",
            "target": {
              "@type": "EntryPoint",
              "urlTemplate": "https://www.jouwwebsiteurl.nl/#contact", // <-- !!! REPLACE with your URL !!!
              "inLanguage": "nl-NL",
              "actionPlatform": [
                "http://schema.org/DesktopWebPlatform",
                "http://schema.org/IOSPlatform",
                "http://schema.org/AndroidPlatform"
              ]
            },
            "result": {
              "@type": "Reservation",
              "name": "Afspraak maken"
            }
      }
    }
    </script>

</head>

<body class="bg-neutral-50 text-neutral-700 antialiased font-poppins">
    <!-- Skip to main content link for accessibility -->
    <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-white z-[100] px-4 py-2 text-brand-primary font-medium rounded-md shadow">Skip to main content</a>

    <!-- Header -->
    <header id="main-header" class="fixed w-full top-0 z-50 py-3 md:py-4 transition-all duration-300">
        <div class="container mx-auto px-4 flex justify-between items-center">
            <!-- Logo -->
            <a href="#home" class="text-2xl md:text-3xl font-bold font-playfair hover:opacity-80 transition duration-300 logo-text" aria-label="Diamond Haarsalon Home">
                Diamond
            </a>

            <!-- Desktop Navigation -->
            <nav class="hidden lg:block" aria-label="Main Navigation">
                <ul class="flex space-x-8">
                    <li><a href="#home" class="font-medium transition duration-300 pb-1 border-b-2 border-transparent hover:border-current hover:text-brand-primary">Home</a></li>
                    <li><a href="#referral-program" class="font-medium transition duration-300 pb-1 border-b-2 border-transparent hover:border-current hover:text-brand-primary">Vrienden Bonus</a></li>
                    <li><a href="#over-ons" class="font-medium transition duration-300 pb-1 border-b-2 border-transparent hover:border-current hover:text-brand-primary">Over Ons</a></li>
                    <li><a href="#galerij" class="font-medium transition duration-300 pb-1 border-b-2 border-transparent hover:border-current hover:text-brand-primary">Galerij</a></li>
                    <li><a href="#contact" class="font-medium transition duration-300 pb-1 border-b-2 border-transparent hover:border-current hover:text-brand-primary">Contact</a></li>
                </ul>
            </nav>

            <!-- Call & Mobile Menu Button -->
            <div class="flex items-center space-x-3">
                <a href="tel:+31627403860" class="phone-link hidden sm:inline-flex items-center hover:text-brand-light font-medium transition duration-300">
                    <i class="fas fa-phone-alt mr-2 text-sm" aria-hidden="true"></i> 06-27403860
                </a>
                 <a href="#contact" class="button-cta hidden lg:inline-flex btn-primary items-center justify-center">Afspraak Maken</a>
                <button id="mobile-menu-button" class="lg:hidden p-2 rounded-md hover:bg-white/10 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white" aria-label="Open hoofdmenu" aria-controls="mobile-menu" aria-expanded="false">
                    <i class="fas fa-bars text-xl" aria-hidden="true"></i>
                </button>
            </div>
        </div>

        <!-- Improved Mobile Menu -->
        <div id="mobile-menu" class="mobile-menu-container lg:hidden z-[49]" role="navigation" aria-label="Mobiel menu">
             <div class="container mx-auto px-4 py-5">
                <ul class="space-y-1">
                    <li><a href="#home" class="mobile-menu-link block py-3 px-4 text-lg font-medium text-neutral-700 hover:bg-gold-light hover:text-brand-dark rounded-lg transition duration-300">Home</a></li>
                    <li><a href="#referral-program" class="mobile-menu-link block py-3 px-4 text-lg font-medium text-neutral-700 hover:bg-gold-light hover:text-brand-dark rounded-lg transition duration-300">Vrienden Bonus</a></li>
                    <li><a href="#over-ons" class="mobile-menu-link block py-3 px-4 text-lg font-medium text-neutral-700 hover:bg-gold-light hover:text-brand-dark rounded-lg transition duration-300">Over Ons</a></li>
                    <li><a href="#galerij" class="mobile-menu-link block py-3 px-4 text-lg font-medium text-neutral-700 hover:bg-gold-light hover:text-brand-dark rounded-lg transition duration-300">Galerij</a></li>
                    <li><a href="#contact" class="mobile-menu-link block py-3 px-4 text-lg font-medium text-neutral-700 hover:bg-gold-light hover:text-brand-dark rounded-lg transition duration-300">Contact</a></li>
                </ul>

                <div class="mt-6 space-y-4">
                    <a href="tel:+31627403860" class="flex items-center justify-center py-3 px-4 text-lg text-brand-primary font-semibold hover:text-brand-dark transition duration-300 bg-gold-light/50 rounded-lg w-full">
                        <i class="fas fa-phone-alt mr-3" aria-hidden="true"></i> Bel 06-27403860
                    </a>
                    <a href="#contact" class="mobile-menu-link btn-primary w-full text-center">
                        <i class="far fa-calendar-alt mr-2" aria-hidden="true"></i> Afspraak Maken
                    </a>
                </div>

                <!-- Social links in mobile menu -->
                <div class="mt-6 pt-4 border-t border-neutral-100">
                    <p class="text-sm text-neutral-500 mb-3 text-center">Volg ons</p>
                    <div class="flex space-x-4 justify-center">
                        <a href="#" target="_blank" rel="noopener noreferrer" class="w-10 h-10 rounded-full bg-neutral-100 hover:bg-gold-light text-neutral-600 hover:text-brand-primary flex items-center justify-center transition duration-300" aria-label="Facebook">
                            <i class="fab fa-facebook-f" aria-hidden="true"></i>
                        </a>
                        <a href="#" target="_blank" rel="noopener noreferrer" class="w-10 h-10 rounded-full bg-neutral-100 hover:bg-gold-light text-neutral-600 hover:text-brand-primary flex items-center justify-center transition duration-300" aria-label="Instagram">
                            <i class="fab fa-instagram" aria-hidden="true"></i>
                        </a>
                        <a href="#" target="_blank" rel="noopener noreferrer" class="w-10 h-10 rounded-full bg-neutral-100 hover:bg-gold-light text-neutral-600 hover:text-brand-primary flex items-center justify-center transition duration-300" aria-label="Pinterest">
                            <i class="fab fa-pinterest" aria-hidden="true"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main id="main-content">

        <!-- Hero Section - REVAMPED -->
        <section id="home" class="relative min-h-screen pt-24 pb-16 md:pt-32 md:pb-24 lg:pb-32 flex items-center bg-cover bg-center bg-neutral-800" style="background-image: url('/Images/SalonMain.jpg');">
            <!-- Overlay -->
            <div class="absolute inset-0 bg-gradient-to-br from-black/70 via-black/50 to-black/75 z-0"></div>

            <!-- Hero Content Container -->
            <div class="container mx-auto px-4 z-10 text-white relative text-center lg:text-left">
                <div class="max-w-3xl mx-auto lg:mx-0 animate-on-scroll animate-fade-in" style="animation-delay: 0.2s;">
                    <h1 class="text-4xl sm:text-5xl md:text-6xl font-bold font-playfair mb-6 leading-tight drop-shadow-md">
                        Ontdek Jouw <span class="text-brand-secondary">Stralende</span> Stijl bij Diamond
                    </h1>
                    <p class="text-lg md:text-xl lg:text-2xl mb-10 font-light max-w-2xl mx-auto lg:mx-0 drop-shadow-sm">
                        Waar vakmanschap en persoonlijke aandacht samenkomen voor de premium haarervaring die jij verdient in Leiden.
                    </p>

                    <div class="flex flex-col sm:flex-row gap-4 justify-center lg:justify-start">
                        <a href="#contact" class="btn-primary flex items-center justify-center text-base sm:text-lg">
                            <i class="far fa-calendar-alt mr-2" aria-hidden="true"></i> Plan Jouw Afspraak
                        </a>
                        <button id="open-price-modal-button" class="btn-secondary text-base sm:text-lg flex items-center justify-center">
                            <i class="fas fa-tags mr-2" aria-hidden="true"></i> Bekijk Prijslijst
                        </button>
                    </div>

                    <!-- Rating Badge -->
                    <div class="mt-12 inline-flex items-center bg-white/10 backdrop-blur-sm py-3 px-5 rounded-lg shadow-sm">
                        <div class="text-yellow-400 flex mr-3 text-lg">
                            <i class="fas fa-star" aria-hidden="true"></i>
                            <i class="fas fa-star" aria-hidden="true"></i>
                            <i class="fas fa-star" aria-hidden="true"></i>
                            <i class="fas fa-star" aria-hidden="true"></i>
                            <i class="fas fa-star-half-alt" aria-hidden="true"></i> <!-- Example: 4.5 stars -->
                        </div>
                        <div class="text-white text-left">
                            <span class="font-medium">4.9 van 5 sterren</span>
                            <span class="text-xs sm:text-sm ml-1 block sm:inline">op basis van 120+ reviews</span>
                        </div>
                    </div>
                </div>
            </div>

             <!-- Scroll Down Indicator -->
            <div class="absolute bottom-8 left-1/2 transform -translate-x-1/2 text-center hidden md:block z-10">
                <a href="#referral-program" class="inline-block text-white/70 hover:text-white animate-bounce-subtle transition-colors" aria-label="Scroll naar beneden">
                    <span class="block mb-1 text-xs font-light">Ontdek Meer</span>
                    <i class="fas fa-chevron-down text-lg" aria-hidden="true"></i>
                </a>
            </div>
        </section>


        <!-- Referral Program Section -->
        <section id="referral-program" class="py-16 md:py-24 bg-white noise-bg">
            <div class="container mx-auto px-4">
                <div class="max-w-5xl mx-auto">
                    <div class="bg-gold-light/30 rounded-2xl p-6 md:p-10 lg:p-12 relative overflow-hidden shadow-lg border border-gold-light/30">
                        <div class="relative z-10">
                            <div class="flex flex-col md:flex-row items-center justify-between gap-8">
                                <div class="md:w-3/5 animate-on-scroll animate-slide-in-left" data-delay="0.1s">
                                    <h2 class="text-3xl md:text-4xl font-bold mb-4 text-brand-dark">
                                        <span class="block">Vrienden Bonus</span>
                                        <span class="block mt-1 text-brand-primary text-2xl md:text-3xl">Deel Diamond & Bespaar!</span>
                                    </h2>
                                    <p class="text-neutral-700 mb-6 text-base md:text-lg">Introduceer een vriend(in) bij Diamond Haarsalon, en jullie ontvangen <strong>beiden 10% korting</strong> op de volgende behandeling. Een win-win!</p>

                                    <h3 class="font-semibold text-lg md:text-xl mb-3 text-brand-dark">Hoe werkt het?</h3>
                                    <ol class="space-y-3 text-neutral-700 mb-8 text-sm md:text-base">
                                        <li class="flex items-start">
                                            <span class="flex-shrink-0 w-6 h-6 rounded-full bg-brand-primary text-white flex items-center justify-center mr-3 mt-0.5 text-xs font-bold">1</span>
                                            <span>Vertel je vrienden enthousiast over jouw ervaring bij Diamond.</span>
                                        </li>
                                        <li class="flex items-start">
                                            <span class="flex-shrink-0 w-6 h-6 rounded-full bg-brand-primary text-white flex items-center justify-center mr-3 mt-0.5 text-xs font-bold">2</span>
                                            <span>Vraag hen jouw naam te noemen bij het maken van hun *eerste* afspraak.</span>
                                        </li>
                                        <li class="flex items-start">
                                            <span class="flex-shrink-0 w-6 h-6 rounded-full bg-brand-primary text-white flex items-center justify-center mr-3 mt-0.5 text-xs font-bold">3</span>
                                            <span>Zij ontvangen direct 10% korting op hun eerste behandeling.</span>
                                        </li>
                                        <li class="flex items-start">
                                            <span class="flex-shrink-0 w-6 h-6 rounded-full bg-brand-primary text-white flex items-center justify-center mr-3 mt-0.5 text-xs font-bold">4</span>
                                            <span>Na hun bezoek, krijg jij automatisch 10% korting op jouw volgende behandeling!</span>
                                        </li>
                                    </ol>

                                    <a href="#contact" class="btn-primary inline-flex items-center">
                                        <i class="fas fa-users mr-2" aria-hidden="true"></i>
                                        Maak Nu Een Afspraak
                                    </a>
                                </div>

                                <div class="md:w-2/5 text-center animate-on-scroll animate-slide-in-right" data-delay="0.2s">
                                    <div class="relative inline-block group">
                                        <!-- Ping animation -->
                                        <div class="absolute inset-0 rounded-full bg-brand-primary/20 animate-ping opacity-60 group-hover:opacity-80 transition-opacity duration-500"></div>
                                        <img src="/Images/Friends.PNG" alt="Twee lachende vriendinnen met mooi haar vieren de Diamond Vrienden Bonus korting" class="relative z-10 rounded-xl shadow-lg transform group-hover:rotate-2 transition-transform duration-500 w-full max-w-[250px] sm:max-w-xs mx-auto" loading="lazy">
                                        <div class="absolute -bottom-3 -right-3 md:-bottom-4 md:-right-4 bg-white rounded-lg shadow-md px-3 py-1.5 md:px-4 md:py-2 transform rotate-3 z-20 group-hover:scale-105 transition-transform duration-300">
                                            <span class="text-brand-primary font-bold text-lg md:text-xl">10%</span>
                                            <span class="block text-xs text-neutral-600">KORTING</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Decorative element -->
                        <div class="absolute bottom-0 right-0 text-brand-primary/5 text-7xl md:text-9xl transform translate-x-1/4 translate-y-1/4 opacity-50 hidden lg:block -z-0" aria-hidden="true">
                            <i class="fas fa-gift"></i>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- About Us Section -->
        <section id="over-ons" class="py-16 md:py-24 bg-neutral-50 overflow-hidden">
            <div class="container mx-auto px-4">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 lg:gap-20 items-center">
                    <div class="relative animate-on-scroll animate-slide-in-left" data-delay="0.1s">
                        <div class="relative rounded-xl overflow-hidden shadow-xl aspect-w-4 aspect-h-3">
                            <img src="/Images/Kapperstoelen.jpg" alt="Stijlvol en modern interieur van Diamond Haarsalon in Leiden" class="w-full h-full object-cover hover-filter" loading="lazy">
                        </div>

                        <!-- Decorative elements -->
                        <div class="absolute -bottom-5 -left-5 w-24 h-24 bg-gold-light rounded-full -z-10 transform -rotate-12 hidden sm:block opacity-70" aria-hidden="true"></div>
                        <div class="absolute -top-5 -right-5 w-20 h-20 bg-brand-primary/10 rounded-lg -z-10 transform rotate-12 hidden sm:block" aria-hidden="true"></div>

                        <!-- Stats card -->
                        <div class="absolute right-0 bottom-5 sm:right-auto sm:left-5 sm:bottom-5 md:-right-4 md:bottom-1/4 bg-white rounded-lg shadow-lg p-3 px-4 text-center w-32 transform transition-transform hover:scale-105 hover:shadow-xl">
                            <div class="text-3xl font-bold text-brand-primary">8+</div>
                            <div class="text-xs text-neutral-600 font-medium">Jaar Ervaring</div>
                        </div>
                    </div>

                    <div class="animate-on-scroll animate-slide-in-right" data-delay="0.2s">
                        <h2 class="text-3xl md:text-4xl lg:text-5xl font-bold mb-6 text-neutral-800">Welkom bij Diamond Haarsalon</h2>
                        <p class="text-neutral-600 mb-6 text-base md:text-lg leading-relaxed">
                            Diamond is meer dan een kapsalon; het is een passieproject geboren in 2015. Gevestigd in het hart van Leiden, creëren we een oase waar topkwaliteit haarverzorging en oprechte, persoonlijke aandacht samenkomen.
                        </p>
                        <p class="text-neutral-600 mb-8 text-sm md:text-base leading-relaxed">
                            Wij geloven dat je kapsel een verlengstuk is van je unieke persoonlijkheid. Daarom nemen we de tijd om te luisteren, geven we eerlijk advies op maat, en gebruiken we onze expertise om een look te creëren die niet alleen prachtig is, maar ook perfect bij jou en je levensstijl past.
                        </p>

                        <h3 class="text-xl font-semibold mb-4 text-neutral-800">Onze Belofte Aan Jou:</h3>
                        <ul class="space-y-4 mb-8">
                            <li class="flex items-start">
                                <div class="bg-brand-light p-2 rounded-full mr-4 mt-1 text-brand-primary flex-shrink-0 shadow-sm">
                                    <i class="fas fa-medal w-5 h-5 text-center" aria-hidden="true"></i>
                                </div>
                                <div>
                                    <span class="font-semibold text-neutral-800 text-base">Uitmuntend Vakmanschap</span>
                                    <p class="text-neutral-600 text-xs sm:text-sm">Constante training in de nieuwste knip- en kleurtechnieken.</p>
                                </div>
                            </li>
                            <li class="flex items-start">
                                <div class="bg-brand-light p-2 rounded-full mr-4 mt-1 text-brand-primary flex-shrink-0 shadow-sm">
                                    <i class="fas fa-heart w-5 h-5 text-center" aria-hidden="true"></i>
                                </div>
                                <div>
                                    <span class="font-semibold text-neutral-800 text-base">Persoonlijke Aandacht</span>
                                    <p class="text-neutral-600 text-xs sm:text-sm">Jouw wensen en haar staan centraal in elke afspraak.</p>
                                </div>
                            </li>
                             <li class="flex items-start">
                                <div class="bg-brand-light p-2 rounded-full mr-4 mt-1 text-brand-primary flex-shrink-0 shadow-sm">
                                    <i class="fas fa-leaf w-5 h-5 text-center" aria-hidden="true"></i>
                                </div>
                                <div>
                                    <span class="font-semibold text-neutral-800 text-base">Premium Producten</span>
                                    <p class="text-neutral-600 text-xs sm:text-sm">Zorgvuldig geselecteerde, hoogwaardige merken voor optimaal resultaat en verzorging.</p>
                                </div>
                            </li>
                            <li class="flex items-start">
                                <div class="bg-brand-light p-2 rounded-full mr-4 mt-1 text-brand-primary flex-shrink-0 shadow-sm">
                                    <i class="fas fa-couch w-5 h-5 text-center" aria-hidden="true"></i>
                                </div>
                                <div>
                                    <span class="font-semibold text-neutral-800 text-base">Ontspannen Sfeer</span>
                                    <p class="text-neutral-600 text-xs sm:text-sm">Een moment van pure rust en verwennerij voor jezelf.</p>
                                </div>
                            </li>
                        </ul>

                        <a href="#contact" class="btn-primary inline-flex items-center">
                            <i class="far fa-calendar-check mr-2" aria-hidden="true"></i>
                            Ervaar Het Zelf
                        </a>
                    </div>
                </div>
            </div>
        </section>

       <!-- Gallery Section -->
        <section id="galerij" class="py-16 md:py-24 bg-neutral-100 relative">
             <!-- Subtle top gradient fade -->
            <div class="absolute top-0 left-0 w-full h-24 bg-gradient-to-b from-neutral-50 to-transparent -z-0"></div>
            <div class="container mx-auto px-4 relative z-10">
                <h2 class="text-3xl md:text-4xl lg:text-5xl font-bold text-center mb-4 animate-on-scroll animate-fade-in text-neutral-800">Inspiratie Galerij</h2>
                <p class="text-center text-neutral-600 max-w-3xl mx-auto mb-12 md:mb-16 text-base md:text-lg animate-on-scroll animate-fade-in">Bekijk een selectie van onze creaties en laat je inspireren voor jouw volgende look.</p>

                <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 md:gap-5">
                    <!-- Gallery Item 1 -->
                    <a href="/Images/Haar.jpg" data-fancybox="gallery" data-caption="Zachte Balayage Highlights voor een natuurlijke look" class="gallery-item group animate-on-scroll animate-scale-in block aspect-w-1 aspect-h-1 rounded-xl overflow-hidden shadow-md">
                        <img src="/Images/Haar.jpg" alt="Close-up van vrouw met zachte, professioneel gekleurde balayage highlights" loading="lazy" class="w-full h-full object-cover">
                        <div class="gallery-overlay">
                            <div class="text-white text-center p-2">
                                <i class="fas fa-search-plus text-3xl mb-1" aria-hidden="true"></i>
                                <p class="text-sm font-medium mt-1">Zachte Balayage</p>
                            </div>
                        </div>
                    </a>

                    <!-- Gallery Item 2 -->
                    <a href="/Images/Salon.jpg" data-fancybox="gallery" data-caption="Moderne strakke herencoupe met fade" class="gallery-item group animate-on-scroll animate-scale-in block aspect-w-1 aspect-h-1 rounded-xl overflow-hidden shadow-md" data-delay="0.05s">
                        <img src="/Images/Salon.jpg" alt="Stijlvolle man met een moderne, strakke herencoupe met fade" loading="lazy" class="w-full h-full object-cover">
                         <div class="gallery-overlay">
                            <div class="text-white text-center p-2">
                                <i class="fas fa-search-plus text-3xl mb-1" aria-hidden="true"></i>
                                <p class="text-sm font-medium mt-1">Moderne Herencoupe</p>
                            </div>
                        </div>
                    </a>

                    <!-- Gallery Item 3 -->
                    <a href="/Images/Salon1.jpg" data-fancybox="gallery" data-caption="Levendige rode kleuring met glans" class="gallery-item group animate-on-scroll animate-scale-in block aspect-w-1 aspect-h-1 rounded-xl overflow-hidden shadow-md" data-delay="0.1s">
                        <img src="/Images/Salon1.jpg" alt="Vrouw met lang haar en een levendige, glanzende rode haarkleuring" loading="lazy" class="w-full h-full object-cover">
                        <div class="gallery-overlay">
                           <div class="text-white text-center p-2">
                                <i class="fas fa-search-plus text-3xl mb-1" aria-hidden="true"></i>
                                <p class="text-sm font-medium mt-1">Levendige Kleuring</p>
                            </div>
                        </div>
                    </a>

                    <!-- Gallery Item 4 -->
                    <a href="/Images/Kapperstoelen.jpg" data-fancybox="gallery" data-caption="Elegante opgestoken updo voor speciale gelegenheden" class="gallery-item group animate-on-scroll animate-scale-in block aspect-w-1 aspect-h-1 rounded-xl overflow-hidden shadow-md" data-delay="0.15s">
                        <img src="/Images/Kapperstoelen.jpg" alt="Elegant opgestoken feestkapsel (updo) met vlechtwerk" loading="lazy" class="w-full h-full object-cover">
                        <div class="gallery-overlay">
                             <div class="text-white text-center p-2">
                                <i class="fas fa-search-plus text-3xl mb-1" aria-hidden="true"></i>
                                <p class="text-sm font-medium mt-1">Elegante Updo</p>
                            </div>
                        </div>
                    </a>

                    <!-- Gallery Item 5 -->
                    <a href="/Images/SalonMain.jpg" data-fancybox="gallery" data-caption="Natuurlijke krullen met definitie en volume" class="gallery-item group animate-on-scroll animate-scale-in block aspect-w-1 aspect-h-1 rounded-xl overflow-hidden shadow-md" data-delay="0.2s">
                        <img src="/Images/SalonMain.jpg" alt="Vrouw met mooi gedefinieerde natuurlijke krullen en volume" loading="lazy" class="w-full h-full object-cover">
                        <div class="gallery-overlay">
                             <div class="text-white text-center p-2">
                                <i class="fas fa-search-plus text-3xl mb-1" aria-hidden="true"></i>
                                <p class="text-sm font-medium mt-1">Natuurlijke Krullen</p>
                            </div>
                        </div>
                    </a>

                    <!-- Gallery Item 6 -->
                     <a href="/Images/Haar.jpg" data-fancybox="gallery" data-caption="Gedurfde korte boblijn met strakke lijnen" class="gallery-item group animate-on-scroll animate-scale-in block aspect-w-1 aspect-h-1 rounded-xl overflow-hidden shadow-md" data-delay="0.25s">
                        <img src="/Images/Haar.jpg" alt="Vrouw met een gedurfde, strak geknipte korte boblijn" loading="lazy" class="w-full h-full object-cover">
                       <div class="gallery-overlay">
                             <div class="text-white text-center p-2">
                                <i class="fas fa-search-plus text-3xl mb-1" aria-hidden="true"></i>
                                <p class="text-sm font-medium mt-1">Strakke Boblijn</p>
                            </div>
                        </div>
                    </a>

                    <!-- Gallery Item 7 -->
                    <a href="/Images/Salon.jpg" data-fancybox="gallery" data-caption="Koel platinum blond met gezonde glans" class="gallery-item group animate-on-scroll animate-scale-in block aspect-w-1 aspect-h-1 rounded-xl overflow-hidden shadow-md" data-delay="0.3s">
                        <img src="/Images/Salon.jpg" alt="Close-up van glanzend, koel platinum blond haar" loading="lazy" class="w-full h-full object-cover">
                        <div class="gallery-overlay">
                             <div class="text-white text-center p-2">
                                <i class="fas fa-search-plus text-3xl mb-1" aria-hidden="true"></i>
                                <p class="text-sm font-medium mt-1">Platinum Blond</p>
                            </div>
                        </div>
                    </a>

                    <!-- Gallery Item 8 -->
                     <a href="/Images/Salon1.jpg" data-fancybox="gallery" data-caption="Verzorgd herenkapsel met subtiele styling" class="gallery-item group animate-on-scroll animate-scale-in block aspect-w-1 aspect-h-1 rounded-xl overflow-hidden shadow-md" data-delay="0.35s">
                        <img src="/Images/Salon1.jpg" alt="Man met een verzorgd, klassiek herenkapsel met lichte styling" loading="lazy" class="w-full h-full object-cover">
                        <div class="gallery-overlay">
                             <div class="text-white text-center p-2">
                                <i class="fas fa-search-plus text-3xl mb-1" aria-hidden="true"></i>
                                <p class="text-sm font-medium mt-1">Verzorgd Herenkapsel</p>
                            </div>
                        </div>
                    </a>
                </div>

                <div class="text-center mt-12 md:mt-16 animate-on-scroll animate-fade-in">
                    <a href="https://instagram.com/" target="_blank" rel="noopener noreferrer" class="btn inline-flex items-center px-6 py-3 bg-gradient-to-r from-pink-500 via-red-500 to-yellow-500 text-white shadow-md hover:shadow-lg transform hover:-translate-y-1 text-sm md:text-base">
                        <i class="fab fa-instagram mr-2 text-lg" aria-hidden="true"></i> Volg Ons Voor Meer Inspiratie
                    </a>
                </div>
            </div>
        </section>


        <!-- Testimonials Section - UPDATED with new reviews -->
        <section class="py-16 md:py-24 bg-white noise-bg">
            <div class="container mx-auto px-4">
                <h2 class="text-3xl md:text-4xl lg:text-5xl font-bold text-center mb-4 animate-on-scroll animate-fade-in text-neutral-800">Wat Klanten Zeggen</h2>
                <p class="text-center text-neutral-600 max-w-3xl mx-auto mb-12 md:mb-16 text-base md:text-lg animate-on-scroll animate-fade-in">Echte ervaringen van tevreden klanten bij Diamond Haarsalon.</p>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- Testimonial 1 - Lana S. -->
                    <div class="bg-neutral-50 p-6 md:p-8 rounded-xl testimonial-card animate-on-scroll animate-slide-up relative hover:shadow-xl transition-shadow duration-300" data-delay="0.1s">
                        <div class="absolute -top-4 -left-4 text-brand-primary/10 text-5xl md:text-6xl z-0 transform -rotate-12" aria-hidden="true">
                            <i class="fas fa-quote-left"></i>
                        </div>
                        <div class="relative z-10">
                            <div class="flex mb-4 text-yellow-400 text-lg">
                                <i class="fas fa-star" aria-hidden="true"></i><i class="fas fa-star" aria-hidden="true"></i><i class="fas fa-star" aria-hidden="true"></i><i class="fas fa-star" aria-hidden="true"></i><i class="fas fa-star" aria-hidden="true"></i>
                            </div>
                            <blockquote class="italic text-neutral-700 mb-6 text-sm md:text-base leading-relaxed">
                                <p>"Ik heb nog nooit zo'n goeie keratine behandeling genomen waarbij mijn haren echt gezond zijn geworden en de service echt perfect! Vriendelijke vrouwen!"</p>
                            </blockquote>
                            <div class="flex items-center mt-auto pt-4 border-t border-neutral-200/60">
                                <div class="w-12 h-12 rounded-full bg-brand-light flex items-center justify-center flex-shrink-0 shadow-sm">
                                    <span class="text-brand-primary font-playfair font-semibold text-xl">L</span>
                                </div>
                                <div class="ml-4">
                                    <cite class="font-semibold text-base text-neutral-800 not-italic">Lana S.</cite>
                                    <p class="text-xs text-neutral-500">Keratine Behandeling</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Testimonial 2 - Loes -->
                    <div class="bg-neutral-50 p-6 md:p-8 rounded-xl testimonial-card animate-on-scroll animate-slide-up relative hover:shadow-xl transition-shadow duration-300" data-delay="0.2s">
                         <div class="absolute -top-4 -left-4 text-brand-primary/10 text-5xl md:text-6xl z-0 transform -rotate-12" aria-hidden="true">
                            <i class="fas fa-quote-left"></i>
                        </div>
                        <div class="relative z-10">
                            <div class="flex mb-4 text-yellow-400 text-lg">
                                <i class="fas fa-star" aria-hidden="true"></i><i class="fas fa-star" aria-hidden="true"></i><i class="fas fa-star" aria-hidden="true"></i><i class="fas fa-star" aria-hidden="true"></i><i class="fas fa-star" aria-hidden="true"></i>
                            </div>
                             <blockquote class="italic text-neutral-700 mb-6 text-sm md:text-base leading-relaxed">
                                <p>"Deze dame wist met twee woorden precies wat ik wilde. Ik wilde een afspraak maken maar werd gelijk geholpen. Ik kom zeker terug. En zal mijn wenkbrauwen laten epileren. Echt TOP."</p>
                            </blockquote>
                            <div class="flex items-center mt-auto pt-4 border-t border-neutral-200/60">
                                <div class="w-12 h-12 rounded-full bg-brand-light flex items-center justify-center flex-shrink-0 shadow-sm">
                                     <span class="text-brand-primary font-playfair font-semibold text-xl">L</span>
                                </div>
                                <div class="ml-4">
                                     <cite class="font-semibold text-base text-neutral-800 not-italic">Loes</cite>
                                    <p class="text-xs text-neutral-500">Knippen & Advies</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Testimonial 3 - Ayse -->
                    <div class="bg-neutral-50 p-6 md:p-8 rounded-xl testimonial-card animate-on-scroll animate-slide-up relative hover:shadow-xl transition-shadow duration-300" data-delay="0.3s">
                         <div class="absolute -top-4 -left-4 text-brand-primary/10 text-5xl md:text-6xl z-0 transform -rotate-12" aria-hidden="true">
                            <i class="fas fa-quote-left"></i>
                        </div>
                        <div class="relative z-10">
                            <div class="flex mb-4 text-yellow-400 text-lg">
                               <i class="fas fa-star" aria-hidden="true"></i><i class="fas fa-star" aria-hidden="true"></i><i class="fas fa-star" aria-hidden="true"></i><i class="fas fa-star" aria-hidden="true"></i><i class="fas fa-star" aria-hidden="true"></i>
                            </div>
                             <blockquote class="italic text-neutral-700 mb-6 text-sm md:text-base leading-relaxed">
                                <p>"De beste kapper waar ik in Nederland ben geweest, het kapsel is geweldig, je moet het proberen!"</p>
                            </blockquote>
                           <div class="flex items-center mt-auto pt-4 border-t border-neutral-200/60">
                                <div class="w-12 h-12 rounded-full bg-brand-light flex items-center justify-center flex-shrink-0 shadow-sm">
                                     <span class="text-brand-primary font-playfair font-semibold text-xl">A</span>
                                </div>
                                <div class="ml-4">
                                     <cite class="font-semibold text-base text-neutral-800 not-italic">Ayse</cite>
                                    <p class="text-xs text-neutral-500">Geweldig Kapsel</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Google Reviews Button -->
                <div class="text-center mt-12 md:mt-16 animate-on-scroll animate-fade-in">
                    <a href="https://www.google.com/maps/search/?api=1&query=Diamond+Haarsalon+Leiden" target="_blank" rel="noopener noreferrer" class="btn inline-flex items-center px-6 py-3 bg-white border border-neutral-300 hover:border-brand-primary text-neutral-700 hover:text-brand-primary rounded-full transition-all duration-300 font-medium shadow-sm hover:shadow-md transform hover:-translate-y-1 text-sm md:text-base">
                        <i class="fab fa-google mr-2 text-lg text-red-600" aria-hidden="true"></i> Lees Meer Reviews op Google
                    </a>
                </div>
            </div>
        </section>

        <!-- Contact Section -->
        <section id="contact" class="py-16 md:py-24 bg-white">
            <div class="container mx-auto px-4">
                <h2 class="text-3xl md:text-4xl lg:text-5xl font-bold text-center mb-4 animate-on-scroll animate-fade-in text-neutral-800">Plan Je Bezoek</h2>
                <p class="text-center text-neutral-600 max-w-3xl mx-auto mb-12 md:mb-16 text-base md:text-lg animate-on-scroll animate-fade-in">Klaar voor jouw transformatie? Neem contact op of kom langs in onze salon in Leiden.</p>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-10 md:gap-12 mb-16">
                    <!-- Contact Info Card 1: Address -->
                    <div class="animate-on-scroll animate-scale-in bg-neutral-50 p-6 md:p-8 rounded-xl shadow-lg border border-neutral-100 text-center md:text-left">
                        <div class="inline-flex md:flex items-center mb-4">
                            <div class="bg-brand-light p-4 rounded-full mr-0 md:mr-4 mb-3 md:mb-0 text-brand-primary inline-block md:inline">
                                <i class="fas fa-map-marker-alt text-2xl w-6 h-6 text-center" aria-hidden="true"></i>
                            </div>
                            <div>
                                <h3 class="text-xl font-semibold mb-2 text-neutral-800">Bezoek Ons Adres</h3>
                                <address class="text-neutral-600 text-sm md:text-base not-italic">
                                    Bevrijdingsplein 19<br>
                                    2321 BW Leiden<br>
                                    Nederland
                                </address>
                                <a href="https://maps.google.com/?q=Bevrijdingsplein+19,+2321+BW+Leiden" target="_blank" rel="noopener noreferrer" class="inline-flex items-center text-brand-primary hover:text-brand-dark mt-3 text-sm font-medium">
                                    <i class="fas fa-directions mr-2" aria-hidden="true"></i> Routebeschrijving
                                </a>
                            </div>
                        </div>
                    </div>

                    <!-- Contact Info Card 2: Hours -->
                     <div class="animate-on-scroll animate-scale-in bg-neutral-50 p-6 md:p-8 rounded-xl shadow-lg border border-neutral-100 text-center md:text-left" data-delay="0.15s">
                        <div class="inline-flex md:flex items-center mb-4">
                            <div class="bg-brand-light p-4 rounded-full mr-0 md:mr-4 mb-3 md:mb-0 text-brand-primary inline-block md:inline">
                                <i class="fas fa-clock text-2xl w-6 h-6 text-center" aria-hidden="true"></i>
                            </div>
                            <div>
                                <h3 class="text-xl font-semibold mb-2 text-neutral-800">Openingstijden</h3>
                                <ul class="text-neutral-600 space-y-1 text-sm md:text-base">
                                    <li class="flex justify-between items-center"><span class="w-20 text-left">Maandag:</span> <span class="font-medium text-red-600">Gesloten</span></li>
                                    <li class="flex justify-between items-center"><span class="w-20 text-left">Dinsdag:</span> <span class="font-medium">09:00 - 18:00</span></li>
                                    <li class="flex justify-between items-center"><span class="w-20 text-left">Woensdag:</span> <span class="font-medium">09:00 - 18:00</span></li>
                                    <li class="flex justify-between items-center"><span class="w-20 text-left">Donderdag:</span> <span class="font-medium">09:00 - 18:00</span></li>
                                    <li class="flex justify-between items-center"><span class="w-20 text-left">Vrijdag:</span> <span class="font-medium">09:00 - 18:00</span></li>
                                    <li class="flex justify-between items-center"><span class="w-20 text-left">Zaterdag:</span> <span class="font-medium">09:00 - 17:00</span></li>
                                    <li class="flex justify-between items-center"><span class="w-20 text-left">Zondag:</span> <span class="font-medium text-red-600">Gesloten</span></li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Contact Info Card 3: Contact -->
                     <div class="animate-on-scroll animate-scale-in bg-neutral-50 p-6 md:p-8 rounded-xl shadow-lg border border-neutral-100 text-center md:text-left" data-delay="0.3s">
                        <div class="inline-flex md:flex items-center mb-4">
                             <div class="bg-brand-light p-4 rounded-full mr-0 md:mr-4 mb-3 md:mb-0 text-brand-primary inline-block md:inline">
                                <i class="fas fa-headset text-2xl w-6 h-6 text-center" aria-hidden="true"></i>
                            </div>
                            <div>
                                <h3 class="text-xl font-semibold mb-2 text-neutral-800">Neem Contact Op</h3>
                                <p class="text-neutral-600 mb-3 text-sm md:text-base">
                                    Vragen of een afspraak maken? Bel of mail ons:
                                </p>
                                <div class="space-y-2">
                                    <a href="tel:+31627403860" class="flex items-center text-brand-primary hover:text-brand-dark justify-center md:justify-start">
                                        <i class="fas fa-phone-alt mr-2 text-sm" aria-hidden="true"></i>
                                        <span class="text-base font-medium">06-27403860</span>
                                    </a>
                                    <a href="mailto:info@diamond.nl" class="flex items-center text-brand-primary hover:text-brand-dark justify-center md:justify-start">
                                        <i class="fas fa-envelope mr-2 text-sm" aria-hidden="true"></i>
                                        <span class="text-base font-medium break-all">info@diamond.nl</span>
                                    </a>
                                </div>
                                <div class="mt-4 pt-4 border-t border-neutral-200/60">
                                    <p class="text-sm text-neutral-500 mb-2">Volg ons ook hier:</p>
                                    <div class="flex space-x-3 justify-center md:justify-start">
                                        <a href="#" target="_blank" rel="noopener noreferrer" class="text-neutral-400 hover:text-blue-600 text-xl transition-colors" aria-label="Facebook">
                                            <i class="fab fa-facebook-f" aria-hidden="true"></i>
                                        </a>
                                        <a href="#" target="_blank" rel="noopener noreferrer" class="text-neutral-400 hover:text-pink-600 text-xl transition-colors" aria-label="Instagram">
                                            <i class="fab fa-instagram" aria-hidden="true"></i>
                                        </a>
                                        <a href="#" target="_blank" rel="noopener noreferrer" class="text-neutral-400 hover:text-red-600 text-xl transition-colors" aria-label="Pinterest">
                                            <i class="fab fa-pinterest-p" aria-hidden="true"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Map -->
                <div class="mt-12 md:mt-16 rounded-xl overflow-hidden shadow-xl animate-on-scroll animate-fade-in border border-neutral-200" style="height: 350px;">
                    <iframe
                        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2448.7823472936173!2d4.4892576!3d52.150899!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x47c5c6b89a13b9cd%3A0xb6c38cf5a37a1e11!2sBevrijdingsplein%2019%2C%202321%20BW%20Leiden!5e0!3m2!1snl!2snl!4v1712373424123!5m2!1snl!2snl"
                        width="100%"
                        height="100%"
                        style="border:0;"
                        allowfullscreen=""
                        loading="lazy"
                        referrerpolicy="no-referrer-when-downgrade"
                        title="Locatie Diamond Haarsalon - Bevrijdingsplein 19, 2321 BW Leiden">
                    </iframe>
                    <!-- Basic Fallback -->
                    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: #eee; display: flex; align-items: center; justify-content: center; z-index: -1;">
                         <p style="color: #666; text-align: center; padding: 1rem;">Kaart wordt geladen...<br>Locatie: Bevrijdingsplein 19, Leiden</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-brand-darker text-neutral-300 pt-16 pb-8 relative overflow-hidden">
         <!-- Subtle background pattern -->
        <div class="absolute inset-0 opacity-[0.03]">
            <svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg"><defs><pattern id="footerPattern" patternUnits="userSpaceOnUse" width="40" height="40" patternTransform="rotate(45)"><path d="M0 10h40M10 0v40" stroke="white" stroke-width="0.5"/></pattern></defs><rect width="100%" height="100%" fill="url(#footerPattern)"/></svg>
        </div>

        <div class="container mx-auto px-4 relative z-10">
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-10 mb-12">
                <!-- Column 1: Logo & About -->
                <div class="lg:col-span-1 sm:col-span-2 lg:pr-8">
                     <a href="#home" class="inline-block mb-5 text-3xl font-bold font-playfair text-brand-secondary hover:opacity-80 transition duration-300">
                        Diamond
                    </a>
                    <p class="text-sm mb-6 leading-relaxed">
                        Jouw premium kapper in Leiden voor professionele haarbehandelingen, persoonlijk advies en een stralend resultaat.
                    </p>
                    <div class="flex space-x-3">
                         <a href="#" target="_blank" rel="noopener noreferrer" aria-label="Facebook" class="w-10 h-10 rounded-full flex items-center justify-center bg-white/10 hover:bg-brand-primary text-white transition-all duration-300 transform hover:scale-110">
                            <i class="fab fa-facebook-f text-base" aria-hidden="true"></i>
                        </a>
                        <a href="#" target="_blank" rel="noopener noreferrer" aria-label="Instagram" class="w-10 h-10 rounded-full flex items-center justify-center bg-white/10 hover:bg-brand-primary text-white transition-all duration-300 transform hover:scale-110">
                            <i class="fab fa-instagram text-base" aria-hidden="true"></i>
                        </a>
                        <a href="#" target="_blank" rel="noopener noreferrer" aria-label="Pinterest" class="w-10 h-10 rounded-full flex items-center justify-center bg-white/10 hover:bg-brand-primary text-white transition-all duration-300 transform hover:scale-110">
                            <i class="fab fa-pinterest-p text-base" aria-hidden="true"></i>
                        </a>
                    </div>
                </div>

                <!-- Column 2: Quick Links -->
                <div>
                    <h4 class="text-lg font-semibold mb-4 text-white font-playfair">Snelle Links</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#home" class="hover:text-white transition-colors flex items-center group"><i class="fas fa-chevron-right text-xs mr-2 text-brand-secondary/70 group-hover:text-brand-secondary transition-colors" aria-hidden="true"></i>Home</a></li>
                        <li><a href="#referral-program" class="hover:text-white transition-colors flex items-center group"><i class="fas fa-chevron-right text-xs mr-2 text-brand-secondary/70 group-hover:text-brand-secondary transition-colors" aria-hidden="true"></i>Vrienden Bonus</a></li>
                        <li><a href="#over-ons" class="hover:text-white transition-colors flex items-center group"><i class="fas fa-chevron-right text-xs mr-2 text-brand-secondary/70 group-hover:text-brand-secondary transition-colors" aria-hidden="true"></i>Over Ons</a></li>
                        <li><a href="#galerij" class="hover:text-white transition-colors flex items-center group"><i class="fas fa-chevron-right text-xs mr-2 text-brand-secondary/70 group-hover:text-brand-secondary transition-colors" aria-hidden="true"></i>Galerij</a></li>
                        <li><a href="#contact" class="hover:text-white transition-colors flex items-center group"><i class="fas fa-chevron-right text-xs mr-2 text-brand-secondary/70 group-hover:text-brand-secondary transition-colors" aria-hidden="true"></i>Contact</a></li>
                        <li><button id="open-price-modal-button-footer" class="hover:text-white transition-colors flex items-center group text-left"><i class="fas fa-chevron-right text-xs mr-2 text-brand-secondary/70 group-hover:text-brand-secondary transition-colors" aria-hidden="true"></i>Prijslijst</button></li>
                        <!-- Add links to privacy/terms pages when available -->
                        <!-- <li><a href="/privacy" class="hover:text-white transition-colors flex items-center group"><i class="fas fa-chevron-right text-xs mr-2 text-brand-secondary/70 group-hover:text-brand-secondary transition-colors" aria-hidden="true"></i>Privacybeleid</a></li> -->
                    </ul>
                </div>

                <!-- Column 3: Popular Services -->
                <div>
                     <h4 class="text-lg font-semibold mb-4 text-white font-playfair">Populaire Diensten</h4>
                     <ul class="space-y-2 text-sm">
                        <li><span class="flex items-center"><i class="fas fa-cut text-xs mr-2 text-brand-secondary/70" aria-hidden="true"></i>Knippen & Stylen</span></li>
                        <li><span class="flex items-center"><i class="fas fa-palette text-xs mr-2 text-brand-secondary/70" aria-hidden="true"></i>Kleuren & Balayage</span></li>
                        <li><span class="flex items-center"><i class="fas fa-spa text-xs mr-2 text-brand-secondary/70" aria-hidden="true"></i>Keratine Treatments</span></li>
                        <li><span class="flex items-center"><i class="fas fa-ring text-xs mr-2 text-brand-secondary/70" aria-hidden="true"></i>Bruidsarrangementen</span></li>
                        <li><span class="flex items-center"><i class="fas fa-user text-xs mr-2 text-brand-secondary/70" aria-hidden="true"></i>Heren Kapsels</span></li>
                        <li><span class="flex items-center"><i class="fas fa-plus text-xs mr-2 text-brand-secondary/70" aria-hidden="true"></i>En meer...</span></li>
                    </ul>
                     <a href="#contact" class="inline-block mt-4 text-sm text-brand-secondary hover:text-white font-medium transition-colors">Boek jouw behandeling <i class="fas fa-arrow-right text-xs ml-1" aria-hidden="true"></i></a>
                </div>

                <!-- Column 4: Contact Info -->
                <div>
                    <h4 class="text-lg font-semibold mb-4 text-white font-playfair">Contact</h4>
                    <ul class="space-y-3 text-sm">
                        <li class="flex items-start">
                             <i class="fas fa-map-marker-alt mt-1 mr-3 text-brand-secondary w-4 text-center flex-shrink-0" aria-hidden="true"></i>
                            <span>
                                Bevrijdingsplein 19,<br>2321 BW Leiden
                            </span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-phone-alt mt-1 mr-3 text-brand-secondary w-4 text-center flex-shrink-0" aria-hidden="true"></i>
                            <a href="tel:+31627403860" class="hover:text-brand-secondary transition-colors">06-27403860</a>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-envelope mt-1 mr-3 text-brand-secondary w-4 text-center flex-shrink-0" aria-hidden="true"></i>
                            <a href="mailto:info@diamond.nl" class="hover:text-brand-secondary transition-colors break-all">info@diamond.nl</a>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-clock mt-1 mr-3 text-brand-secondary w-4 text-center flex-shrink-0" aria-hidden="true"></i>
                            <span>Di-Vr: 9-18 | Za: 9-17</span>
                        </li>
                    </ul>
                     <div class="mt-5 p-3 bg-white/5 rounded-lg border border-white/10">
                        <a href="#referral-program" class="block hover:opacity-80 transition-opacity">
                            <span class="text-sm font-medium text-brand-secondary block mb-1">🌟 Vrienden Bonus</span>
                            <p class="text-xs text-neutral-300 leading-snug">Tip: 10% korting voor jou & je vriend(in)!</p>
                        </a>
                    </div>
                </div>
            </div>

            <div class="border-t border-neutral-700/50 mt-10 pt-6 text-center text-neutral-400 text-xs">
                <p>&copy; <span id="current-year"></span> Diamond Haarsalon Leiden. Alle rechten voorbehouden.</p>
                 <!-- Add links to privacy/terms pages when available -->
                <!-- <p class="mt-1"><a href="/privacy" class="hover:text-white transition-colors">Privacybeleid</a> | <a href="/voorwaarden" class="hover:text-white transition-colors">Algemene Voorwaarden</a></p> -->
            </div>
        </div>
    </footer>


    <!-- Floating Action Buttons -->
    <div class="fixed bottom-5 right-5 z-50 flex flex-col-reverse items-end space-y-3 sm:bottom-6 sm:right-6">
        <!-- Scroll To Top Button (initially hidden) -->
        <button id="scroll-top-btn" aria-label="Scroll naar boven" class="floating-btn bg-white text-brand-primary rounded-full w-12 h-12 sm:w-14 sm:h-14 flex items-center justify-center shadow-lg hover:bg-brand-light opacity-0 transition-opacity duration-300 pointer-events-none">
            <i class="fas fa-arrow-up text-lg" aria-hidden="true"></i>
        </button>

        <!-- Floating Referral Button (initially hidden) -->
        <a id="floating-referral" href="#referral-program" class="floating-btn bg-gradient-to-br from-yellow-400 to-orange-500 hover:from-yellow-500 hover:to-orange-600 text-white rounded-full w-12 h-12 sm:w-14 sm:h-14 flex flex-col items-center justify-center shadow-lg opacity-0 transition-opacity duration-300 pointer-events-none" aria-label="Bekijk Vrienden Bonus">
            <i class="fas fa-gift text-lg" aria-hidden="true"></i>
            <span class="text-[9px] font-semibold mt-0.5 block leading-none uppercase">Bonus</span>
        </a>
    </div>

    <!-- Chat Widget -->
    <div id="chatbot" class="fixed bottom-5 right-5 z-[60] sm:bottom-6 sm:right-6">
        <!-- Chat Button -->
        <button id="chat-button" class="floating-btn bg-brand-primary hover:bg-brand-dark text-white rounded-full w-14 h-14 sm:w-16 sm:h-16 flex items-center justify-center transition-all duration-300" aria-label="Open Chat" aria-haspopup="dialog" aria-expanded="false">
            <i id="chat-button-icon" class="fas fa-comments text-xl sm:text-2xl transition-transform duration-300" aria-hidden="true"></i>
             <!-- Notification dot example -->
            <!-- <span class="absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full border-2 border-white animate-pulse"></span> -->
            <!-- Online indicator -->
             <span class="absolute top-0 right-0 block h-3.5 w-3.5 rounded-full bg-green-500 border-2 border-white ring-white ring-1"></span>
        </button>

        <!-- Chat Window -->
        <div id="chat-window" class="hidden absolute bottom-[calc(100%+0.75rem)] sm:bottom-[calc(100%+1rem)] right-0 w-80 sm:w-96 bg-white rounded-2xl shadow-2xl overflow-hidden border border-neutral-200 scale-95 opacity-0 flex flex-col" role="dialog" aria-modal="true" aria-labelledby="chat-header-title">
            <!-- Chat Header -->
            <div class="bg-gradient-to-r from-brand-dark to-brand-primary p-3 sm:p-4 text-white flex justify-between items-center flex-shrink-0">
                <div class="flex items-center">
                    <div class="w-8 h-8 sm:w-10 sm:h-10 rounded-full bg-white/20 flex items-center justify-center mr-2 sm:mr-3 border-2 border-white/30 flex-shrink-0 shadow-inner">
                        <i class="fas fa-user-headset text-sm sm:text-base" aria-hidden="true"></i>
                    </div>
                    <div>
                        <h3 id="chat-header-title" class="font-semibold text-sm sm:text-base">Diamond Hulp</h3>
                        <p class="text-xs text-gold-light/90 flex items-center">
                            <span class="w-2 h-2 bg-green-400 rounded-full inline-block mr-1.5"></span> Online
                        </p>
                    </div>
                </div>
                <button id="close-chat" class="text-white/70 hover:text-white transition duration-300 w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/10 focus:outline-none focus:ring-2 focus:ring-white/50" aria-label="Sluit chat">
                    <i class="fas fa-times text-base sm:text-lg" aria-hidden="true"></i>
                </button>
            </div>

            <!-- Chat Messages Area -->
            <div id="chat-messages" class="p-3 sm:p-4 h-64 sm:h-80 overflow-y-auto bg-neutral-50 space-y-4 flex-grow">
                <!-- Initial message might be added here by JS -->
                <noscript>
                    <div class="text-center text-neutral-500 text-sm p-4">JavaScript is vereist voor de chatfunctie.</div>
                </noscript>
            </div>

            <!-- Chat Input Area -->
            <div class="p-3 sm:p-4 border-t border-neutral-200 bg-white flex-shrink-0">
                <div class="flex items-end space-x-2">
                    <textarea id="chat-input" placeholder="Typ je bericht..." class="flex-1 form-textarea w-full rounded-full border-neutral-300 focus:border-brand-secondary focus:ring focus:ring-brand-secondary/50 transition duration-300 py-2 px-3.5 text-xs sm:text-sm resize-none max-h-24 overflow-y-auto" autocomplete="off" rows="1" disabled></textarea>
                    <button id="send-message" class="bg-brand-primary hover:bg-brand-dark text-white rounded-full w-9 h-9 sm:w-10 sm:h-10 flex items-center justify-center transition duration-300 flex-shrink-0 disabled:opacity-50 disabled:cursor-not-allowed" aria-label="Verstuur bericht" disabled>
                        <i class="fas fa-paper-plane text-sm sm:text-base" aria-hidden="true"></i>
                    </button>
                </div>
                 <p class="text-xs text-neutral-400 text-center mt-2">Powered by AI Assistant</p>
            </div>
        </div>
    </div>


     <!-- Price List Modal -->
    <div id="price-modal" class="fixed inset-0 z-[70] bg-black/70 backdrop-blur-sm hidden items-center justify-center p-4 transition-opacity duration-300 ease-in-out opacity-0" aria-labelledby="price-modal-title" role="dialog" aria-modal="true">
        <!-- Modal Content Container -->
        <div class="flex items-center justify-center min-h-full w-full">
            <div class="bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col overflow-hidden transform scale-95 transition-all duration-300 ease-in-out">
                <!-- Modal Header -->
                <div class="flex justify-between items-center p-4 sm:p-6 border-b border-neutral-200 flex-shrink-0 bg-neutral-50 rounded-t-xl">
                    <h2 id="price-modal-title" class="text-xl sm:text-2xl font-semibold font-playfair text-neutral-800">Prijslijst Diamond Haarsalon</h2>
                    <button id="close-price-modal-button" class="text-neutral-500 hover:text-neutral-800 transition-colors rounded-full w-8 h-8 flex items-center justify-center hover:bg-neutral-200 focus:outline-none focus:ring-2 focus:ring-brand-primary" aria-label="Sluit prijslijst">
                        <i class="fas fa-times text-lg" aria-hidden="true"></i>
                    </button>
                </div>
                <!-- Modal Body -->
                <div id="price-modal-body" class="p-4 sm:p-6 overflow-y-auto flex-grow space-y-6 bg-white">
                    <!-- Price Category 1: Dames -->
                    <div class="price-category">
                        <h3 class="text-lg font-semibold mb-3 text-brand-primary border-b-2 pb-1 border-brand-light font-playfair">Dames</h3>
                        <ul class="space-y-2.5 text-sm text-neutral-700">
                            <li class="flex justify-between items-center"><span>Knippen, Wassen, Drogen</span> <span class="font-medium text-neutral-800">€ 59,50</span></li>
                            <li class="flex justify-between items-center"><span>Knippen, Wassen, Föhnen/Stylen</span> <span class="font-medium text-neutral-800">€ 75,00</span></li>
                            <li class="flex justify-between items-center"><span>Uitgroei Kleuren <small>(max 2cm)</small></span> <span class="font-medium text-neutral-800">Vanaf € 89,50</span></li>
                            <li class="flex justify-between items-center"><span>Volledige Kleuring</span> <span class="font-medium text-neutral-800">Vanaf € 110,00</span></li>
                            <li class="flex justify-between items-center"><span>Highlights / Lowlights <small>(Half Hoofd)</small></span> <span class="font-medium text-neutral-800">Vanaf € 115,00</span></li>
                            <li class="flex justify-between items-center"><span>Highlights / Lowlights <small>(Heel Hoofd)</small></span> <span class="font-medium text-neutral-800">Vanaf € 150,00</span></li>
                            <li class="flex justify-between items-center"><span>Balayage / Ombre</span> <span class="font-medium text-neutral-800">Vanaf € 175,00</span></li>
                            <li class="flex justify-between items-center"><span>Toner / Glossing</span> <span class="font-medium text-neutral-800">Vanaf € 45,00</span></li>
                        </ul>
                    </div>
                    <!-- Price Category 2: Heren -->
                    <div class="price-category border-t border-neutral-200 pt-6 mt-6">
                         <h3 class="text-lg font-semibold mb-3 text-brand-primary border-b-2 pb-1 border-brand-light font-playfair">Heren</h3>
                        <ul class="space-y-2.5 text-sm text-neutral-700">
                            <li class="flex justify-between items-center"><span>Knippen, Wassen, Stylen</span> <span class="font-medium text-neutral-800">€ 42,50</span></li>
                            <li class="flex justify-between items-center"><span>Buzz Cut (Tondeuse)</span> <span class="font-medium text-neutral-800">€ 25,00</span></li>
                            <li class="flex justify-between items-center"><span>Baard Trimmen / Contouren</span> <span class="font-medium text-neutral-800">€ 15,00</span></li>
                            <li class="flex justify-between items-center"><span>Kleuring</span> <span class="font-medium text-neutral-800">Vanaf € 55,00</span></li>
                        </ul>
                    </div>
                    <!-- Price Category 3: Extra's -->
                    <div class="price-category border-t border-neutral-200 pt-6 mt-6">
                         <h3 class="text-lg font-semibold mb-3 text-brand-primary border-b-2 pb-1 border-brand-light font-playfair">Extra's & Verzorging</h3>
                         <ul class="space-y-2.5 text-sm text-neutral-700">
                            <li class="flex justify-between items-center"><span>Intensief Haarmasker</span> <span class="font-medium text-neutral-800">€ 15,00</span></li>
                            <li class="flex justify-between items-center"><span>Olaplex Herstelbehandeling</span> <span class="font-medium text-neutral-800">Vanaf € 39,95</span></li>
                            <li class="flex justify-between items-center"><span>Keratine Behandeling</span> <span class="font-medium text-neutral-800">Op aanvraag</span></li>
                            <li class="flex justify-between items-center"><span>Bruids- / Feestkapsel</span> <span class="font-medium text-neutral-800">Op aanvraag</span></li>
                            <li class="flex justify-between items-center"><span>Wenkbrauwen Epileren / Harsen</span> <span class="font-medium text-neutral-800">€ 12,50</span></li>
                            <li class="flex justify-between items-center"><span>Wenkbrauwen Verven</span> <span class="font-medium text-neutral-800">€ 15,00</span></li>
                        </ul>
                    </div>
                    <p class="text-xs text-neutral-500 italic text-center mt-4 px-4">Let op: Prijzen zijn indicatief en 'vanaf'-prijzen. De uiteindelijke prijs is afhankelijk van haarlengte, dikte, de benodigde tijd en specifieke wensen. Vraag uw stylist vooraf om een exacte prijsopgave.</p>
                </div>
                <!-- Modal Footer -->
                <div class="p-4 bg-neutral-50 border-t border-neutral-200 text-right flex-shrink-0 rounded-b-xl">
                     <a href="#contact" id="price-modal-book-button" class="btn-primary text-sm mr-2">
                        <i class="far fa-calendar-alt mr-2" aria-hidden="true"></i> Afspraak Maken
                    </a>
                    <button id="close-price-modal-button-footer" class="px-4 py-2 bg-neutral-200 text-neutral-700 rounded-md hover:bg-neutral-300 transition-colors text-sm font-medium">Sluiten</button>
                </div>
            </div>
        </div>
    </div>


    <!-- JavaScript - Improved & Organized -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log("DOM fully loaded and parsed");

            // --- Elements References ---
            const getElement = (id) => document.getElementById(id);
            const querySelector = (selector) => document.querySelector(selector);
            const querySelectorAll = (selector) => document.querySelectorAll(selector);

            const header = getElement('main-header');
            const mobileMenuButton = getElement('mobile-menu-button');
            const mobileMenu = getElement('mobile-menu');
            const mobileMenuLinks = mobileMenu?.querySelectorAll('.mobile-menu-link');
            const menuIcon = mobileMenuButton?.querySelector('i');
            const priceModal = getElement('price-modal');
            const openPriceModalButton = getElement('open-price-modal-button');
            const openPriceModalButtonFooter = getElement('open-price-modal-button-footer'); // Added footer button
            const closePriceModalButton = getElement('close-price-modal-button');
            const closePriceModalButtonFooter = getElement('close-price-modal-button-footer');
            const priceModalContentContainer = priceModal?.querySelector('.flex.items-center.justify-center'); // Target outer container for click outside
            const priceModalContent = priceModal?.querySelector('.bg-white.rounded-xl'); // Target content for animation
            const priceModalBookButton = getElement('price-modal-book-button');
            const floatingReferral = getElement('floating-referral');
            const scrollTopBtn = getElement('scroll-top-btn');
            const currentYearSpan = getElement('current-year');

            // --- Constants ---
            const SCROLL_THRESHOLD = 50; // Pixels scrolled before header changes style
            const FLOATING_REFERRAL_THRESHOLD = 300; // Pixels scrolled before referral FAB appears
            const SCROLL_TOP_THRESHOLD = 400; // Pixels scrolled before scroll-to-top FAB appears

            // --- Helper Functions ---
            const showElement = (el) => {
                if (!el) return;
                el.classList.remove('hidden', 'opacity-0', 'pointer-events-none');
                // Force reflow before adding opacity class for transition
                void el.offsetWidth;
                el.classList.add('opacity-100');
            };

            const hideElement = (el, delay = 300) => {
                 if (!el || el.classList.contains('opacity-0')) return; // Already hiding or hidden
                 el.classList.remove('opacity-100');
                 el.classList.add('opacity-0', 'pointer-events-none');
                 // Use setTimeout to add 'hidden' after the transition ends
                 setTimeout(() => {
                     // Check again in case state changed quickly
                     if (el.classList.contains('opacity-0')) {
                         el.classList.add('hidden');
                     }
                 }, delay);
            };

            // --- Header, Floating Buttons & Scroll Handling ---
            const handleScrollEvents = () => {
                if (!header) return;
                const scrollY = window.scrollY;

                // Header styling
                if (scrollY > SCROLL_THRESHOLD) {
                    header.classList.add('header-scrolled');
                } else {
                    header.classList.remove('header-scrolled');
                }

                // Floating Referral Button Visibility
                if (floatingReferral) {
                    if (scrollY > FLOATING_REFERRAL_THRESHOLD) {
                        showElement(floatingReferral);
                    } else {
                        hideElement(floatingReferral);
                    }
                }

                // Scroll To Top Button Visibility
                if (scrollTopBtn) {
                    if (scrollY > SCROLL_TOP_THRESHOLD) {
                       showElement(scrollTopBtn);
                    } else {
                        hideElement(scrollTopBtn);
                    }
                }
            };

            // Scroll to top function
            const scrollToTop = () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };

            // Add scroll event listener (throttled slightly for performance if needed)
            // let scrollTimeout;
            // window.addEventListener('scroll', () => {
            //     clearTimeout(scrollTimeout);
            //     scrollTimeout = setTimeout(handleScrollEvents, 50); // Adjust delay as needed
            // }, { passive: true });
            window.addEventListener('scroll', handleScrollEvents, { passive: true });


            // Initial check on load
            handleScrollEvents();

            // Scroll to top button click handler
            if (scrollTopBtn) {
                scrollTopBtn.addEventListener('click', scrollToTop);
            }

            // --- Improved Mobile Menu ---
            const toggleMobileMenu = (forceClose = false) => {
                if (!mobileMenu || !menuIcon || !mobileMenuButton) return;

                const isOpen = mobileMenu.classList.contains('menu-open');

                if (forceClose && !isOpen) return; // Nothing to do if forcing close and already closed

                 if (!forceClose && isOpen) { // Closing
                    mobileMenu.classList.remove('menu-open');
                    mobileMenuButton.setAttribute('aria-expanded', 'false');
                    menuIcon.classList.remove('fa-times');
                    menuIcon.classList.add('fa-bars');
                    document.body.style.overflow = ''; // Allow body scroll
                 } else if (!isOpen) { // Opening
                    mobileMenu.classList.add('menu-open');
                    mobileMenuButton.setAttribute('aria-expanded', 'true');
                    menuIcon.classList.remove('fa-bars');
                    menuIcon.classList.add('fa-times');
                    document.body.style.overflow = 'hidden'; // Prevent body scroll
                 }
            };

            if (mobileMenuButton && mobileMenu) {
                mobileMenuButton.addEventListener('click', () => toggleMobileMenu());

                // Close menu when a link is clicked
                mobileMenuLinks?.forEach(link => {
                    link.addEventListener('click', () => toggleMobileMenu(true)); // Force close
                });

                // Close menu on Escape key
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && mobileMenu.classList.contains('menu-open')) {
                        toggleMobileMenu(true); // Force close
                    }
                });

                // Close menu if clicked outside (only if the menu is open)
                document.addEventListener('click', (e) => {
                    if (mobileMenu.classList.contains('menu-open') &&
                        !mobileMenu.contains(e.target) &&
                        !mobileMenuButton.contains(e.target)) {
                        toggleMobileMenu(true); // Force close
                    }
                });
            }


            // --- Price Modal Handling ---
            const openPriceModal = () => {
                if (!priceModal || !priceModalContent) return;
                priceModal.classList.remove('hidden');
                priceModal.classList.add('flex'); // Use flex for centering
                document.body.style.overflow = 'hidden';

                requestAnimationFrame(() => { // Ensure transition applies correctly
                    priceModal.classList.remove('opacity-0');
                    priceModalContent.classList.remove('scale-95');
                    priceModal.classList.add('opacity-100');
                    priceModalContent.classList.add('scale-100');
                });

                closePriceModalButton?.focus(); // Focus on close button for accessibility
            };

            const closePriceModal = () => {
                if (!priceModal || !priceModalContent || priceModal.classList.contains('hidden')) return;

                priceModal.classList.remove('opacity-100');
                priceModalContent.classList.remove('scale-100');
                priceModal.classList.add('opacity-0');
                priceModalContent.classList.add('scale-95');

                setTimeout(() => {
                    priceModal.classList.add('hidden');
                    priceModal.classList.remove('flex');
                    document.body.style.overflow = '';
                    // Return focus to the button that opened the modal, if possible
                    openPriceModalButton?.focus();
                }, 300); // Match transition duration
            };

            // Event listeners for price modal
            if (priceModal && priceModalContent && closePriceModalButton && closePriceModalButtonFooter) {
                openPriceModalButton?.addEventListener('click', openPriceModal);
                openPriceModalButtonFooter?.addEventListener('click', openPriceModal); // Footer button opens too
                closePriceModalButton.addEventListener('click', closePriceModal);
                closePriceModalButtonFooter.addEventListener('click', closePriceModal);
                priceModalBookButton?.addEventListener('click', closePriceModal); // Close modal when clicking book button

                // Close on backdrop click (click on the semi-transparent background)
                 priceModal.addEventListener('click', (event) => {
                    // Check if the click is directly on the modal background, not its children
                    if (event.target === priceModal) {
                        closePriceModal();
                    }
                });

                // Close on Escape key
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && !priceModal.classList.contains('hidden')) {
                        closePriceModal();
                    }
                });
            } else {
                 console.warn("Price modal elements not fully found.");
            }


            // --- Animation on Scroll ---
            const animatedElements = querySelectorAll('.animate-on-scroll');
            if (window.IntersectionObserver) {
                const observerOptions = {
                    root: null, // viewport
                    rootMargin: '0px',
                    threshold: 0.15 // Trigger when 15% of the element is visible
                };

                const animationObserver = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const element = entry.target;
                            const animationName = getComputedStyle(element).getPropertyValue('--animation-name').trim() || 'fadeIn';
                            const delay = element.getAttribute('data-delay') || '0s';
                            const duration = '0.8s'; // Standard duration
                            const fillMode = 'forwards'; // Keep final state
                            // Dynamic easing for more pop
                            const easing = 'cubic-bezier(0.215, 0.610, 0.355, 1.000)';

                            element.style.animation = `${animationName} ${duration} ${easing} ${delay} ${fillMode}`;
                            element.classList.add('is-visible'); // Add class to mark as animated

                            observer.unobserve(element); // Stop observing once animated
                        }
                    });
                }, observerOptions);

                animatedElements.forEach(el => animationObserver.observe(el));
            } else {
                // Fallback for older browsers: just show the elements
                 console.warn("Intersection Observer not supported, animations disabled.");
                 animatedElements.forEach(el => el.style.opacity = 1);
            }


            // --- Initialize Fancybox ---
            if (typeof Fancybox !== 'undefined') {
                 console.log("Initializing Fancybox...");
                Fancybox.bind("[data-fancybox]", {
                    Thumbs: { showOnStart: false },
                    Images: { zoom: false }, // Disable default zoom on click
                    Toolbar: {
                        display: {
                            left: ["infobar"],
                            middle: [
                                "zoomIn", // Add zoom buttons
                                "zoomOut",
                                // "rotateCCW",
                                // "rotateCW",
                                // "flipX",
                                // "flipY",
                            ],
                            right: ["close"],
                        },
                    },
                     Hash: false, // Disable URL hash changes
                     idle: false, // Don't hide controls on idle
                    // Custom caption generation
                    caption: function (fancybox, slide) {
                        return slide.triggerEl?.dataset.caption || "";
                    }
                });
            } else {
                console.warn("Fancybox library not found or not loaded yet.");
            }

            // --- Update Footer Year ---
            if (currentYearSpan) {
                currentYearSpan.textContent = new Date().getFullYear();
            }

            // --- Smooth Scroll for Internal Links ---
            querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    const href = this.getAttribute('href');
                    // Ensure it's a valid ID selector and not just "#"
                    if (href && href.length > 1 && href.startsWith('#')) {
                        const targetId = href.substring(1);
                        const targetElement = getElement(targetId);

                        if (targetElement) {
                            e.preventDefault(); // Prevent default jump only if target exists

                            // Calculate offset based on header height (adjust if header height changes)
                            const headerHeight = header ? header.offsetHeight : 80;
                            const elementPosition = targetElement.getBoundingClientRect().top;
                            const offsetPosition = elementPosition + window.scrollY - headerHeight - 10; // Extra 10px padding

                            window.scrollTo({
                                top: offsetPosition,
                                behavior: 'smooth'
                            });

                            // Optionally close mobile menu if open after clicking a link
                             if (mobileMenu && mobileMenu.classList.contains('menu-open')) {
                                toggleMobileMenu(true); // Force close
                            }
                        }
                    }
                });
            });


           // --- Chat Widget Functionality (Refactored) ---
            const chatWidget = {
                elements: {
                    widget: getElement('chatbot'),
                    toggleBtn: getElement('chat-button'),
                    toggleIcon: getElement('chat-button-icon'),
                    container: getElement('chat-window'),
                    closeBtn: getElement('close-chat'),
                    messagesContainer: getElement('chat-messages'),
                    input: getElement('chat-input'),
                    sendBtn: getElement('send-message')
                },
                state: {
                    isOpen: false,
                    isProcessing: false,
                    threadId: null,
                    messages: [], // { content: string, isUser: bool, timestamp: string }
                    initialized: false,
                    typingTimeout: null
                },
                storage: {
                    THREAD_ID: 'diamond_chat_thread_id_v3', // Incremented version
                    MESSAGES: 'diamond_chat_messages_v3'
                },
                api: {
                    // IMPORTANT: These are placeholders. Your actual backend endpoints must handle these.
                    createThread: '/api/openai-api/create-thread',
                    addMessage: '/api/openai-api/add-message',
                    createRun: '/api/openai-api/create-run',
                    checkStatus: '/api/openai-api/check-run-status',
                    getMessages: '/api/openai-api/get-messages'
                },

                init: function() {
                    if (!this.elements.widget || !this.elements.toggleBtn || !this.elements.container) {
                        console.warn("Chat widget base elements not found. Chat disabled.");
                        return;
                    }
                    if (!this.elements.closeBtn || !this.elements.messagesContainer || !this.elements.input || !this.elements.sendBtn) {
                        console.warn("Chat widget interactive elements not fully found. Functionality might be limited.");
                    }

                    console.log("Chat Widget: Initializing...");
                    this.loadState();
                    this.setupEventListeners();
                    this.updateInputState(); // Set initial disabled state

                    // Determine initialization path
                    if (this.state.threadId) {
                        console.log("Chat: Resuming session with Thread ID:", this.state.threadId);
                        this.loadMessages(); // Display stored messages
                        // Optionally, fetch latest state from backend if needed, but keep it simple first
                        this.state.initialized = true;
                        this.updateInputState();
                    } else {
                        console.log("Chat: No previous session found, will initialize on first interaction or open.");
                        // Don't add welcome message until opened or first message sent
                    }
                },

                setupEventListeners: function() {
                    this.elements.toggleBtn?.addEventListener('click', () => this.toggleChat());
                    this.elements.closeBtn?.addEventListener('click', () => this.closeChat());
                    this.elements.sendBtn?.addEventListener('click', () => this.handleSendMessage());

                    this.elements.input?.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter' && !e.shiftKey) {
                            e.preventDefault();
                            if (!this.elements.sendBtn?.disabled) {
                                this.handleSendMessage();
                            }
                        }
                    });

                    this.elements.input?.addEventListener('input', () => {
                        this.updateInputState(); // Enable/disable send button based on input
                         // Auto-resize textarea
                         if (this.elements.input) {
                            this.elements.input.style.height = 'auto'; // Reset height
                             const maxHeight = 96; // 6rem (Tailwind max-h-24)
                             const scrollHeight = this.elements.input.scrollHeight;
                             const newHeight = Math.min(scrollHeight, maxHeight);
                            this.elements.input.style.height = `${newHeight}px`;
                         }
                    });

                    // Close on Escape key when chat window is focused
                    this.elements.container?.addEventListener('keydown', (e) => {
                        if (e.key === 'Escape' && this.state.isOpen) {
                            this.closeChat();
                        }
                    });

                    // Close on clicking outside the chat window/button
                    document.addEventListener('click', (e) => {
                        if (this.state.isOpen && this.elements.container && this.elements.toggleBtn) {
                            if (!this.elements.container.contains(e.target) && !this.elements.toggleBtn.contains(e.target)) {
                                this.closeChat();
                            }
                        }
                    });
                },

                updateInputState: function() {
                     if (!this.elements.input || !this.elements.sendBtn) return;
                     const canSend = this.state.initialized && !this.state.isProcessing && this.elements.input.value.trim() !== '';
                     this.elements.input.disabled = !this.state.initialized || this.state.isProcessing;
                     this.elements.sendBtn.disabled = !canSend;
                     this.elements.input.placeholder = this.state.initialized ? "Typ je bericht..." : "Chat wordt gestart...";
                },

                toggleChat: function() {
                    this.state.isOpen ? this.closeChat() : this.openChat();
                },

                openChat: async function() {
                     if (!this.elements.container || !this.elements.toggleBtn || !this.elements.toggleIcon || this.state.isOpen) return;

                    console.log("Chat: Opening chat window...");
                    this.elements.container.classList.remove('hidden');

                    // Animate chat window in
                    requestAnimationFrame(() => {
                        this.elements.container.classList.remove('scale-95', 'opacity-0');
                        this.elements.container.classList.add('scale-100', 'opacity-100');
                    });

                    // Animate button icon change & hide button
                    this.elements.toggleIcon.classList.remove('fa-comments');
                    this.elements.toggleIcon.classList.add('fa-times');
                    this.elements.toggleBtn.classList.add('scale-90', 'opacity-0', 'pointer-events-none');
                     // Don't hide completely, just make non-interactive
                    // setTimeout(() => this.elements.toggleBtn.classList.add('hidden'), 200);

                    this.state.isOpen = true;
                    this.elements.toggleBtn.setAttribute('aria-expanded', 'true');
                    this.scrollToBottom(true); // Instant scroll on open

                     // Initialize if not already done
                     if (!this.state.initialized) {
                        await this.initializeChatSession();
                     }

                    setTimeout(() => {
                        this.elements.input?.focus();
                    }, 350); // Delay focus until transition likely complete
                },

                closeChat: function() {
                     if (!this.elements.container || !this.elements.toggleBtn || !this.elements.toggleIcon || !this.state.isOpen) return;

                    console.log("Chat: Closing chat window...");
                    // Animate chat window out
                    this.elements.container.classList.remove('scale-100', 'opacity-100');
                    this.elements.container.classList.add('scale-95', 'opacity-0');

                     // Animate button icon change & show button
                     this.elements.toggleIcon.classList.remove('fa-times');
                     this.elements.toggleIcon.classList.add('fa-comments');
                    this.elements.toggleBtn.classList.remove('scale-90', 'opacity-0', 'pointer-events-none');
                     // this.elements.toggleBtn.classList.remove('hidden');

                    setTimeout(() => {
                        this.elements.container.classList.add('hidden'); // Hide after animation
                        this.state.isOpen = false;
                        this.elements.toggleBtn.setAttribute('aria-expanded', 'false');
                    }, 300); // Match transition duration
                },

                 initializeChatSession: async function() {
                     console.log("Chat: Initializing session...");
                     this.state.isProcessing = true;
                     this.updateInputState();
                     try {
                         if (!this.state.threadId) {
                             this.state.threadId = await this.apiCall('createThread', this.api.createThread, 'POST');
                             console.log("Chat: New thread created:", this.state.threadId);
                         }

                         // Add welcome message if no messages exist
                         if (this.state.messages.length === 0) {
                             const welcomeMessage = "👋 Hallo! Ik ben de AI assistent van Diamond. Stel gerust je vragen over diensten, prijzen, of het maken van een afspraak.";
                             this.addMessageToState(welcomeMessage, false); // Add to state first
                             this.addMessageToUI(welcomeMessage, false, false); // Then add to UI without animation
                         }

                         this.state.initialized = true;
                         this.saveState(); // Save threadId and potential welcome message
                     } catch (error) {
                         console.error('Chat Error: Failed to initialize chat session.', error);
                         this.addMessageToUI("Kon de chat niet starten. Probeer het later opnieuw of bel ons.", false, true);
                         this.state.initialized = false;
                         this.resetState(); // Clear potentially bad state
                     } finally {
                         this.state.isProcessing = false;
                         this.updateInputState();
                     }
                 },


                loadState: function() {
                    try {
                        const threadId = localStorage.getItem(this.storage.THREAD_ID);
                        const messagesJson = localStorage.getItem(this.storage.MESSAGES);

                        if (threadId) this.state.threadId = threadId;

                        if (messagesJson) {
                            const parsedMessages = JSON.parse(messagesJson);
                             // Basic validation
                             if (Array.isArray(parsedMessages) && parsedMessages.every(m => typeof m.content === 'string' && typeof m.isUser === 'boolean')) {
                                this.state.messages = parsedMessages;
                             } else {
                                 console.warn("Chat Warning: Invalid message format in localStorage, resetting messages.");
                                 this.state.messages = [];
                             }
                        } else {
                            this.state.messages = [];
                        }
                        console.log("Chat State Loaded:", { threadId: this.state.threadId, messageCount: this.state.messages.length });
                    } catch (error) {
                        console.error('Chat Error: Failed to load state from localStorage.', error);
                        this.resetState(); // Clear corrupted state
                    }
                },

                saveState: function() {
                    try {
                        if (this.state.threadId) {
                            localStorage.setItem(this.storage.THREAD_ID, this.state.threadId);
                        } else {
                            localStorage.removeItem(this.storage.THREAD_ID);
                        }
                        // Store only the last ~30 messages to prevent storage bloat
                        const messagesToStore = this.state.messages.slice(-30);
                        localStorage.setItem(this.storage.MESSAGES, JSON.stringify(messagesToStore));
                    } catch (error) {
                        console.error('Chat Error: Failed to save state to localStorage.', error);
                    }
                },

                resetState: function() {
                    console.log("Chat: Resetting chat state.");
                    this.state.threadId = null;
                    this.state.messages = [];
                    this.state.initialized = false;
                    this.state.isProcessing = false;
                    localStorage.removeItem(this.storage.THREAD_ID);
                    localStorage.removeItem(this.storage.MESSAGES);
                    if (this.elements.messagesContainer) this.elements.messagesContainer.innerHTML = '';
                     this.updateInputState(); // Reflect reset state in UI
                },

                loadMessages: function() {
                    if (!this.elements.messagesContainer) return;
                    this.elements.messagesContainer.innerHTML = ''; // Clear existing
                    this.state.messages.forEach(message => {
                        // Add messages without animation on load
                        this.addMessageToUI(message.content, message.isUser, false);
                    });
                    this.scrollToBottom(true); // Scroll instantly on load
                },

                handleSendMessage: async function() {
                    if (!this.elements.input || !this.elements.sendBtn) return;
                    const messageText = this.elements.input.value.trim();

                    if (!messageText || !this.state.initialized || this.state.isProcessing) {
                        console.warn("Chat Warning: Cannot send message.", { initialized: this.state.initialized, processing: this.state.isProcessing, text: messageText });
                        return;
                    }

                    this.state.isProcessing = true;
                    this.updateInputState();
                    this.elements.input.value = ''; // Clear input immediately
                    this.elements.input.style.height = 'auto'; // Reset height

                    // Add user message to UI and state
                    this.addMessageToUI(messageText, true, true);
                    this.addMessageToState(messageText, true);
                    this.saveState(); // Save user message immediately

                    this.showTypingIndicator();

                    try {
                         // 1. Add message to the thread via API
                         await this.apiCall('addMessage', this.api.addMessage, 'POST', {
                             threadId: this.state.threadId,
                             content: messageText
                         });

                         // 2. Create a run to process the message
                         const runData = await this.apiCall('createRun', this.api.createRun, 'POST', {
                             threadId: this.state.threadId
                         });
                         const runId = runData.id;

                        // 3. Poll for run completion
                        const finalStatus = await this.pollRunStatus(runId);

                        // 4. Process result based on status
                         if (finalStatus === 'completed') {
                            await this.fetchAndDisplayResponse(runId);
                         } else {
                              console.error(`Chat Error: Run ended with unhandled status: ${finalStatus}`);
                              throw new Error(`Chat kon niet worden voltooid (status: ${finalStatus}).`);
                         }

                    } catch (error) {
                        console.error('Chat Error: Failed during message sending process.', error);
                         this.removeTypingIndicator();
                         const errorMsg = `Sorry, er ging iets mis: ${error.message || 'Onbekende fout'}. Probeer het opnieuw of bel ons.`;
                         this.addMessageToUI(errorMsg, false, true);
                         this.addMessageToState(errorMsg, false); // Save error message
                         this.saveState();
                    } finally {
                        this.state.isProcessing = false;
                         this.updateInputState();
                         this.removeTypingIndicator(); // Ensure typing indicator is removed
                         this.elements.input?.focus(); // Refocus input
                    }
                },

                 pollRunStatus: async function(runId) {
                     if (!this.state.threadId || !runId) throw new Error("Missing threadId or runId for polling.");

                     let attempts = 0;
                     const maxAttempts = 40; // Increased attempts for potentially longer runs
                     const pollInterval = 1500; // 1.5 seconds

                     while (attempts < maxAttempts) {
                         attempts++;
                         await new Promise(resolve => setTimeout(resolve, pollInterval));
                         console.log(`Chat API: Checking run ${runId} status (Attempt ${attempts})...`);

                         try {
                             // Use GET with query parameters
                             const statusUrl = `${this.api.checkStatus}?threadId=${this.state.threadId}&runId=${runId}`;
                             const statusData = await this.apiCall('checkStatus', statusUrl, 'GET');
                             const status = statusData.status;
                             console.log('Chat API: Run status:', status);

                             if (['completed', 'failed', 'expired', 'cancelled', 'requires_action'].includes(status)) {
                                 return status; // Return the final status
                             }
                             // Continue polling if 'queued' or 'in_progress'
                         } catch (pollError) {
                             console.warn(`Chat Warning: Status check attempt ${attempts} failed.`, pollError);
                             // Don't immediately fail on polling errors, could be transient
                             if (attempts > maxAttempts - 5) { // Only fail if polling fails near the end
                                 throw new Error(`Kon de chat status niet controleren na ${attempts} pogingen.`);
                             }
                         }
                     }

                     // If loop finishes without a final status
                     throw new Error('Timeout: Wachten op antwoord van de assistent duurde te lang.');
                 },

                 fetchAndDisplayResponse: async function(runId) {
                    console.log('Chat API: Run completed. Fetching messages...');
                    try {
                         // Fetch latest messages, ordered descending, limit to find the assistant's response
                        const messagesUrl = `${this.api.getMessages}?threadId=${this.state.threadId}&limit=5&order=desc`;
                        const messagesData = await this.apiCall('getMessages', messagesUrl, 'GET');

                        // Find the first assistant message matching the completed runId
                        const assistantMessage = messagesData.data?.find(msg =>
                             msg.role === 'assistant' && msg.run_id === runId && msg.content?.[0]?.type === 'text'
                        );

                        if (assistantMessage) {
                            const responseContent = assistantMessage.content[0].text.value;
                            console.log('Chat API: Assistant response found:', responseContent.substring(0, 70) + '...');
                            this.addMessageToUI(responseContent, false, true);
                            this.addMessageToState(responseContent, false, new Date(assistantMessage.created_at * 1000).toISOString());
                            this.saveState();
                        } else {
                            console.warn('Chat Warning: Run completed, but no suitable assistant message found.', { runId, messagesData });
                            throw new Error("Antwoord ontvangen, maar kon het niet correct weergeven.");
                        }
                    } catch (error) {
                         console.error('Chat Error: Failed to fetch or display response.', error);
                         // Add specific error message to UI
                         const errorMsg = `Fout bij ophalen antwoord: ${error.message || 'Onbekende fout'}.`;
                         this.addMessageToUI(errorMsg, false, true);
                         this.addMessageToState(errorMsg, false);
                         this.saveState();
                    } finally {
                        this.removeTypingIndicator();
                    }
                 },

                 apiCall: async function(actionName, url, method = 'GET', body = null) {
                     console.log(`Chat API Call: ${actionName} (${method} ${url})`);
                     try {
                         const options = {
                             method: method,
                             headers: { 'Content-Type': 'application/json' }
                         };
                         if (body && method !== 'GET') {
                             options.body = JSON.stringify(body);
                         }

                         const response = await fetch(url, options);

                         // Check for non-OK status codes (4xx, 5xx)
                         if (!response.ok) {
                             let errorDetail = `HTTP error ${response.status}`;
                             try {
                                 // Try to parse error details from the response body
                                 const errorData = await response.json();
                                 errorDetail = errorData.detail || errorData.message || JSON.stringify(errorData);
                             } catch (parseError) {
                                 // If parsing fails, use the status text
                                 errorDetail = response.statusText || errorDetail;
                             }
                              console.error(`Chat API Error (${actionName}): ${response.status} - ${errorDetail}`);
                             throw new Error(`API Fout (${actionName}): ${errorDetail}`);
                         }

                         // Handle potential empty responses (e.g., for 204 No Content)
                         if (response.status === 204 || response.headers.get('content-length') === '0') {
                            console.log(`Chat API Success (${actionName}): Empty response (status ${response.status})`);
                            return null; // Or return an empty object {} if appropriate
                         }

                         // Try to parse JSON response
                          try {
                            const data = await response.json();
                            console.log(`Chat API Success (${actionName}):`, data);
                            return data;
                          } catch (jsonError) {
                              console.error(`Chat API Error (${actionName}): Failed to parse JSON response.`, jsonError);
                              throw new Error(`API Fout (${actionName}): Ongeldig antwoordformaat.`);
                          }

                     } catch (error) {
                          // Catch network errors or errors thrown above
                           console.error(`Chat API Exception (${actionName}):`, error);
                           // Re-throw the error to be caught by the calling function
                           throw error;
                     }
                 },

                addMessageToState: function(content, isUser, timestamp = null) {
                    this.state.messages.push({
                        content: content,
                        isUser: isUser,
                        timestamp: timestamp || new Date().toISOString()
                    });
                    // Optional: Limit message history size in state
                    // if (this.state.messages.length > 50) {
                    //     this.state.messages.shift();
                    // }
                },

                addMessageToUI: function(content, isUser, animate = true) {
                    if (!this.elements.messagesContainer) return;

                    const messageWrapper = document.createElement('div');
                    messageWrapper.className = `flex items-end gap-2.5 mb-3 ${isUser ? 'justify-end' : 'justify-start'}`;

                    // Consistent bubble styling, adjusted corners
                    const bubbleBaseClasses = 'leading-snug p-2.5 sm:p-3 shadow-sm text-xs sm:text-sm font-normal max-w-full break-words'; // Added break-words
                    const userBubbleClasses = 'bg-neutral-200 rounded-xl rounded-br-none text-neutral-800';
                    const assistantBubbleClasses = 'bg-white rounded-xl rounded-bl-none text-neutral-800 border border-neutral-100 shadow-md';

                    const formattedContent = this.formatMessageContent(content);

                    let innerHTML = '';
                    // Assistant Avatar (only if not user)
                    if (!isUser) {
                        innerHTML += `
                            <div class="flex-shrink-0 w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-brand-light flex items-center justify-center text-brand-primary self-end shadow-inner">
                                <i class="fas fa-robot text-xs sm:text-sm" aria-hidden="true"></i>
                            </div>`;
                    }

                    // Message Bubble Container
                    innerHTML += `
                        <div class="flex flex-col gap-1 ${isUser ? 'items-end' : 'items-start'} max-w-[85%] sm:max-w-[80%]">
                            ${!isUser ? '<span class="text-xs font-semibold text-neutral-500 ml-1">Diamond Bot</span>' : ''}
                            <div class="${bubbleBaseClasses} ${isUser ? userBubbleClasses : assistantBubbleClasses}">
                                ${formattedContent}
                            </div>
                        </div>`;

                     // User Avatar (Placeholder - only if user) - Optional styling
                     if (isUser) {
                         innerHTML += `
                             <div class="flex-shrink-0 w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-gradient-to-br from-brand-secondary to-brand-primary flex items-center justify-center text-white self-end shadow-inner">
                                 <i class="fas fa-user text-xs sm:text-sm" aria-hidden="true"></i>
                             </div>`;
                     }

                    messageWrapper.innerHTML = innerHTML;

                    // Animation logic
                    if (animate) {
                        messageWrapper.style.opacity = '0';
                        messageWrapper.style.transform = `translateY(15px)`; // Slide up effect
                         messageWrapper.style.transition = 'opacity 0.4s ease-out, transform 0.4s ease-out';
                         this.elements.messagesContainer.appendChild(messageWrapper);
                         // Use requestAnimationFrame to ensure the transition applies after append
                         requestAnimationFrame(() => {
                              requestAnimationFrame(() => { // Double RAF for safety in some browsers
                                messageWrapper.style.opacity = '1';
                                messageWrapper.style.transform = 'translateY(0)';
                              });
                         });
                    } else {
                         this.elements.messagesContainer.appendChild(messageWrapper);
                    }

                    this.scrollToBottom();
                },

                formatMessageContent: function(content) {
                     // Basic sanitization first (prevent basic HTML injection)
                    let formattedText = content.replace(/</g, "&lt;").replace(/>/g, "&gt;");

                     // Make URLs clickable (improved regex)
                     const urlRegex = /(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[A-Z0-9+&@#\/%=~_|])/ig;
                     formattedText = formattedText.replace(urlRegex, (url) => {
                        // Truncate long URLs visually if needed
                        let displayUrl = url.length > 50 ? url.substring(0, 47) + '...' : url;
                        return `<a href="${url}" target="_blank" rel="noopener noreferrer" class="text-brand-primary underline hover:text-brand-dark break-all">${displayUrl}</a>`;
                     });

                     // Simple Markdown-like formatting (bold, italic - optional)
                     formattedText = formattedText.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>'); // Bold **text**
                     formattedText = formattedText.replace(/\*(.*?)\*/g, '<em>$1</em>');       // Italic *text*

                    // Convert newlines to <br> tags for display in HTML
                    formattedText = formattedText.replace(/\n/g, '<br>');

                    return formattedText;
                },

                showTypingIndicator: function() {
                    if (!this.elements.messagesContainer || document.getElementById('typing-indicator')) return; // Already exists

                    console.log("Chat: Showing typing indicator...");
                    const typingDiv = document.createElement('div');
                    typingDiv.id = 'typing-indicator';
                    typingDiv.className = 'flex items-end gap-2.5 mb-3 justify-start'; // Match message structure

                    // Re-use message styling for consistency
                    typingDiv.innerHTML = `
                        <div class="flex-shrink-0 w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-brand-light flex items-center justify-center text-brand-primary self-end shadow-inner">
                            <i class="fas fa-robot text-xs sm:text-sm" aria-hidden="true"></i>
                        </div>
                        <div class="flex flex-col gap-1 max-w-[85%] sm:max-w-[80%]">
                             <span class="text-xs font-semibold text-neutral-500 ml-1">Diamond Bot</span>
                            <div class="leading-snug p-2.5 sm:p-3 bg-white rounded-xl rounded-bl-none shadow-md border border-neutral-100">
                                <div class="flex space-x-1.5 items-center h-4">
                                    <div class="w-2 h-2 bg-neutral-400 rounded-full animate-bounce" style="animation-delay: -0.32s;"></div>
                                    <div class="w-2 h-2 bg-neutral-400 rounded-full animate-bounce" style="animation-delay: -0.16s;"></div>
                                    <div class="w-2 h-2 bg-neutral-400 rounded-full animate-bounce"></div>
                                </div>
                            </div>
                        </div>
                    `;

                    // Animate in smoothly
                     typingDiv.style.opacity = '0';
                     typingDiv.style.transform = 'translateY(15px)';
                     typingDiv.style.transition = 'opacity 0.4s ease-out, transform 0.4s ease-out';
                     this.elements.messagesContainer.appendChild(typingDiv);

                     requestAnimationFrame(() => {
                          requestAnimationFrame(() => {
                            typingDiv.style.opacity = '1';
                            typingDiv.style.transform = 'translateY(0)';
                          });
                     });


                    this.scrollToBottom();

                    // Safety timeout to remove indicator if API hangs indefinitely
                    if (this.state.typingTimeout) clearTimeout(this.state.typingTimeout);
                    this.state.typingTimeout = setTimeout(() => {
                        console.warn("Chat Warning: Typing indicator auto-removed after timeout.");
                        this.removeTypingIndicator();
                    }, 45000); // 45 seconds timeout
                },

                removeTypingIndicator: function() {
                     if (this.state.typingTimeout) {
                        clearTimeout(this.state.typingTimeout);
                        this.state.typingTimeout = null;
                    }
                    const typingIndicator = document.getElementById('typing-indicator');
                    if (typingIndicator) {
                        console.log("Chat: Removing typing indicator...");
                         typingIndicator.style.opacity = '0';
                         typingIndicator.style.transform = 'translateY(10px)'; // Optional: slide out
                        setTimeout(() => typingIndicator.remove(), 400); // Remove after fade
                    }
                },

                scrollToBottom: function(instant = false) {
                    if (!this.elements.messagesContainer) return;
                    this.elements.messagesContainer.scrollTo({
                        top: this.elements.messagesContainer.scrollHeight,
                        behavior: instant ? 'instant' : 'smooth'
                    });
                }
            };

            // Initialize the chat widget
            chatWidget.init();

             console.log("All initializations complete.");
        });
    </script>

</body>
</html>
